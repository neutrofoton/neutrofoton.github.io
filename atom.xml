<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[neutrofoton]]></title>
  <link href="http://neutrofoton.github.io/atom.xml" rel="self"/>
  <link href="http://neutrofoton.github.io/"/>
  <updated>2021-04-19T10:05:49+07:00</updated>
  <id>http://neutrofoton.github.io/</id>
  <author>
    <name><![CDATA[neutro]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Math and Computation in Neural Network]]></title>
    <link href="http://neutrofoton.github.io/blog/2021/04/06/math-and-computation-in-neural-network/"/>
    <updated>2021-04-06T08:10:48+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2021/04/06/math-and-computation-in-neural-network</id>
    <content type="html"><![CDATA[<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/></p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js"></script>


<p>An Artificial Neural Network (ANN) is a series of algorithms that endeavors to recognize underlying relationships in a set of data through a process that mimics the way the human brain operates[1]. Neuron typically has a weight that adjusts as learning proceeds. This article focuses on the basic mathematical and computation process in the ANN.</p>

<h1>Artificial Neuron</h1>

<p>An artificial neuron is a mathematical function that models biological neurons. A Neuron can receive input from other neurons. The neuron inputs are weighted with <span class="katex" id="omega1"></span> and summed (<span class="katex" id="sigma1"></span>) them before being passed through into an activation function. Figure 1 shows the structure of an artificial neuron.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-neuron.png" width="70%" height="70%"></p>

<center><small>Figure 1: Artificial Neuron <br/>
        </small>
</center>


<p><br/>
<br/></p>

<p>ANN is a supervised learning that its operation involves a dataset. The dataset is labeled and split into two part at least, namely training and testing. We have expected output (from the label) for each input. During the training process, the parameter weights and biases are updated in order to achieve a result that is close to the labeled data. To identify model performance, we evaluate the model to the testing dataset to verify how good the trained model is. To get more detail how ANN learn, let begin with the last two neurons connection.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-simple-neuron-connection.png" width="40%" height="40%"></p>

<center><small>Figure 2: Simple Two Neuron Connection<br/>
        </small>
</center>


<p><span  class="eq-expression katex" id="symbol_activation_neuron_a" ></span> is a neuron with an activation <br/>
<span  class="eq-expression katex" id="symbol_layer_L" ></span> is an index of layer. It is not an exponential.</p>

<script>
    katex.render("a ", symbol_activation_neuron_a);
    katex.render("L ", symbol_layer_L);
</script>


<p>In the training phase, the sample data is fed through the ANN. The outcome of the ANN is inspected and compared to the expected result (the label). The difference between the outcome and expected result is called Cost/Error/Loss. There are several cost functions can be used to evaluate the cost in analyzing model performance. One of the common ones is the quadratic cost function.</p>

<p>The cost for the network in Figure 2 in form of quadratic cost function is:</p>

<div class="eq">
        <span  class="eq-expression katex" id="cost_formula_last_layer_one_neuron" ></span>
        <span class="eq-no">Eq (1)</span>
</div>


<p>The total cost of a feed through the ANN are:</p>

<div class="eq">
        <span  class="eq-expression katex" id="cost_formula_last_layer_all_neuron" ></span>
        <span class="eq-no">Eq (2)</span>
</div>


<p>Equation (1) and (2) show that the closer the outcome of ANN to the expected result, the smaller the cost will be. The cost can be thought as a mathematical function of weights and biases  <span  class="eq-expression katex" id="cost_as_func_of_weight_bias" ></span>. Hence, the fittest model can be achieved by minimizing the cost to find the suitable weights and biases.</p>

<script>
        katex.render("C_{0} = (a^{(L)} - y)^2", cost_formula_last_layer_one_neuron);
        katex.render("Cost (C) = \\sum_j (a_j - y_j)^2", cost_formula_last_layer_all_neuron);
        katex.render("C(\\omega_1, b_1, \\omega_2, b_2, \\omega_3, b_3 )", cost_as_func_of_weight_bias);
</script>


<h1>Gradient Decent</h1>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-derivative-direction.png" width="40%" height="40%"></p>

<center><small>Figure 3: Gradient vector in the direction of vector U<br/>
        </small>
</center>


<p><br/></p>

<p>In multivariable calculus, gradient of a function presented as <span  class="eq-expression katex" id="grad_f" ></span>. Gradient of a function <span  class="eq-expression katex" id="func_f" ></span> in the direction of vector <span  class="eq-expression katex" id="vector_u" ></span> in Figure 3 expressed as:</p>

<div class="eq">
        <span  class="eq-expression katex" id="grad_f_direction_u" ></span>
        <span class="eq-no">Eq (3)</span>
</div>


<p>If <span  class="eq-expression katex" id="vector_u_1" ></span> is a unit vector, the <span  class="eq-expression katex" id="vector_u_length" ></span>. Thus, the Equation (3) can be written as</p>

<div class="eq">
        <span  class="eq-expression katex" id="grad_f_direction_u_unit" ></span>
        <span class="eq-no">Eq (4)</span>
</div>


<p>The maximum result of Equation (4) gained at <span  class="eq-expression katex" id="phi_equal_0" ></span>. Since the <span  class="eq-expression katex" id="vector_u_2" ></span> is a unit vector, it can be evaluated from <span  class="eq-expression katex" id="grad_f_1" ></span> as</p>

<div class="eq">
        <span  class="eq-expression katex" id="u_unit_from_grad_f" ></span> <br/><br/>
        <span  class="eq-expression katex" id="grad_f_direction_its_self" ></span>
</div>


<p>The minimum slope / steepest descent is gained at the opposite of the steepest ascent (at <span  class="eq-expression katex" id="phi_equal_pi" ></span>)</p>

<div class="eq">
        <span  class="eq-expression katex" id="u_unit_from_grad_f_direction_opposite" ></span> <br/><br/>
        <span  class="eq-expression katex" id="grad_f_direction_its_self_direction_opposite" ></span>
</div>


<p>Since ANN is essentially minimizing the cost function, the gradient descent is used as basic idea to find the best fit ANN parameters (weights and biases) in the learning process.</p>

<div class="eq">
        <span  class="eq-expression katex" id="weight_update" ></span>
        <span class="eq-no">Eq (5)</span>
        
</div>




<div class="eq">
        <span  class="eq-expression katex" id="weight_update_matrix" ></span>
</div>


<p>The same method also implemented to get bias update.</p>

<div class="eq">
        <span  class="eq-expression katex" id="bias_update" ></span>
        <span class="eq-no">Eq (6)</span>
</div>


<p><span  class="eq-expression katex" id="eta_1" ></span> is a learning rate. It is an additional value added how much the gradient vector we use to change the current value of weights and biases to the new ones. If <span  class="eq-expression katex" id="eta_2" ></span> is too small, adjustment of weight will slow. The convergency to local minimum will longer. However, if it is too high, the search of local minimum might be oscillated or reach overshoot. Ilustration of gradient descent in 3 dimention plot ilustrated in the Figure 4. Of course it is hard to plot the gradient descent that cover all weights of the ANN.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-gradient-descent-ilustration.png" width="70%" height="70%"></p>

<center><small>Figure 4: Gradient descent ilustration<br/>
        </small>
</center>


<p><br/></p>

<p>Iterative training will let the cost function gradient move in the direction of green line to the local minimum as ilustrated in Figure 4. In fact, gaining global minimum is the ideal condition. However it is very difficult since we start the movement from a random location (random weight at initial training). Reaching local minimum is acceptable in finding the optimal model. If we want a better model, we can retrain the ANN by generating new random or setting different initial values of weights and biases.</p>

<script>
    katex.render("\\nabla f", grad_f);
    katex.render("\\nabla f", grad_f_1);

    katex.render("f", func_f);
    katex.render("\\vec{u}", vector_u);
    katex.render("\\vec{u}", vector_u_1); 
    katex.render("\\vec{u}", vector_u_2); 

    katex.render("D_u f = \\nabla f \\cdot \\vec{u} = \\vert \\nabla f \\vert  \\vert \\vec{u} \\vert cos \\phi", grad_f_direction_u);

    katex.render("\\vert \\vec{u} \\vert = 1", vector_u_length);

     katex.render("D_u f = \\nabla f \\cdot \\vec{u} = \\vert \\nabla f \\vert  cos \\phi", grad_f_direction_u_unit);

     katex.render("\\phi = 0", phi_equal_0); 

     katex.render("\\vec{u} = \\frac{\\nabla f}{\\vert \\nabla f \\vert}", u_unit_from_grad_f); 

     katex.render("\\therefore D_{\\frac{\\nabla f}{\\vert \\nabla f \\vert}} f = \\nabla f \\cdot \\frac{\\nabla f}{\\vert \\nabla f \\vert} = \\frac{\\vert \\nabla f \\vert ^ 2}{\\vert \\nabla f \\vert} = \\vert \\nabla f \\vert \\to maximum \\space slope ", grad_f_direction_its_self);

     katex.render("\\phi = \\pi", phi_equal_pi);

     katex.render("\\vec{u} = \\frac{\\nabla f}{\\vert \\nabla f \\vert} \\cdot (-1) \\to opposite \\space direction", u_unit_from_grad_f_direction_opposite); 

     katex.render("\\therefore D_{\\frac{\\nabla f}{\\vert \\nabla f \\vert}_{descent}} f = \\nabla f \\cdot \\lbrack - \\frac{\\nabla f}{\\vert \\nabla f \\vert} \\rbrack = -\\frac{\\vert \\nabla f \\vert ^ 2}{\\vert \\nabla f \\vert} = - \\vert \\nabla f \\vert \\to minimum \\space slope ", grad_f_direction_its_self_direction_opposite);

     katex.render("\\omega^{+} = \\omega - \\eta \\nabla C", weight_update);
     katex.render("b^{+}  = b - \\eta \\nabla C", bias_update);

     katex.render("\\begin{bmatrix}  \\omega_{1}^{+} \\\\  \\\\ \\omega_{2}^{+} \\\\ \\\\ \\vdots \\\\ \\\\  \\omega_{n}^{+} \\end{bmatrix} = \\begin{bmatrix}  \\omega_{1} \\\\  \\\\ \\omega_{2} \\\\ \\\\ \\vdots \\\\ \\\\  \\omega_{n} \\end{bmatrix} -  \\eta \\begin{bmatrix}  \\frac{\\partial C}{\\partial \\omega_{1}} \\\\  \\\\ \\frac{\\partial C}{\\partial \\omega_{2}} \\\\ \\\\ \\vdots \\\\ \\\\  \\frac{\\partial C}{\\partial \\omega_{n}} \\end{bmatrix}", weight_update_matrix);

    katex.render("\\eta", eta_1);
    katex.render("\\eta", eta_2);
</script>


<h1>Mathematical Notion</h1>

<p>Previously has been discussed that the basic idea to find the optimal model is the gradient of a multivariable function. The topic of the gradient in calculus cannot be separated from the discussion of function theory and derivative. Since an ANN can have several <span  class="eq-expression katex" id="L_layer" ></span>  layers, the chaining function and chaining derivative are needed in analyzing its mathematical notion. The <a href="https://www.youtube.com/watch?v=tIeHLnjs5U8&amp;ab_channel=3Blue1Brown">3Blue1Brown team</a> has a good illustration in describing chain function and derivative in ANN graphically. This article adopts the illustration in describing the chaining rule.</p>

<p>By using the neuron topology in Figure 1, we can identify that:</p>

<div class="eq">
        <span  class="eq-expression katex" id="aL_func_omega_bias" ></span>
        <span class="eq-no">Eq (7)</span>
</div>


<p>Let define <span class="eq-expression katex" id="a_z_0"></span> to simplify mathematical expression.</p>

<div class="eq">
        <span  class="eq-expression katex" id="zL_func_omega_bias" ></span>
        <span class="eq-no">Eq (8)</span>
</div>


<script>
    katex.render("L", L_layer);
    katex.render("a^{L} = \\sigma(\\omega^{(L)} a^{(L-1)} + b^{(L)})", aL_func_omega_bias);
    katex.render("z^{(L)} = \\omega^{(L)} a^{(L-1)} + b^{(L)}", zL_func_omega_bias);
    
</script>


<p>Thus,</p>

<div class="eq">
        <span  class="eq-expression katex" id="aL_func_sigma_z" ></span>
        <span class="eq-no">Eq (9)</span>
</div>


<script>
    katex.render("a^{(L)} = \\sigma(z^{(L)})", aL_func_sigma_z);
</script>


<p>Correlation between variables described graphically as:</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-one-neuron-chain-rule.png" width="40%" height="40%"></p>

<center><small>Figure 5: A cost chaining rule in a layer<br/>
        </small>
</center>


<p><br/></p>

<p>The graphical correlation can be extended to the previous neuron.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-two-neuron-chain-rule.png" width="40%" height="40%"></p>

<center><small>Figure 6: A cost chaining rule in two layers<br/>
        </small>
</center>


<p><br/>
The sensitivity of cost function to the change of weight is expressed as:</p>

<div class="eq">
        <span  class="eq-expression katex" id="dir_partial_C0_to_omega_chain" ></span>
        <span class="eq-no">Eq (10)</span>
</div>


<script>
    katex.render("\\frac{\\partial C_{0}}{\\partial \\omega^{(L)}} = \\frac{\\partial C_{0}}{\\partial a^{(L)}}  \\frac{\\partial a^{(L)}}{\\partial z^{(L)}}  \\frac{\\partial z^{(L)}}{\\partial \\omega^{(L)}} " , dir_partial_C0_to_omega_chain);
</script>


<p>From Equation (1) and (10)</p>

<div class="eq">
        <span  class="eq-expression katex" id="dir_partial_C0_to_omega_result" ></span>
</div>


<script>
    katex.render("\\frac{\\partial C_{0}}{\\partial a^{(L)}} = 2(a^{(L)} - y) " , dir_partial_C0_to_omega_result);
</script>


<p>The coeficient of 2 indicates that deviation between <span  class="eq-expression katex" id="symbol_aL" ></span> and <span  class="eq-expression katex" id="symbol_y" ></span> significantly gives impact to the <span  class="eq-expression katex" id="symbol_partial_C_to_a" ></span></p>

<script>
    katex.render("a^{(L)}" , symbol_aL);
    katex.render("(y)" , symbol_y);
    katex.render("\\frac{\\partial C_{0}}{\\partial a^{(L)}}" , symbol_partial_C_to_a);
</script>


<p>From Equation (9) and (10)</p>

<div class="eq">
        <span  class="eq-expression katex" id="from_eq_9_10" ></span>
</div>


<script>
    katex.render("\\frac{\\partial a^{(L)}}{\\partial z^{(L)}} = \\sigma'(z^{(L)}) " , from_eq_9_10);
</script>


<p>From Equation (8) and (10)</p>

<div class="eq">
        <span  class="eq-expression katex" id="from_eq_8_10" ></span>
</div>


<script>
    katex.render("\\frac{\\partial z^{(L)}}{\\partial \\omega^{(L)}} = a^{(L-1)} " , from_eq_8_10);
</script>


<p>So mathematical expression in Equation (10) can be written as:</p>

<div class="eq">
        <span  class="eq-expression katex" id="from_eq_10_extend" ></span>
</div>




<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_omega_substitute" ></span>
        <span class="eq-no">Eq (11)</span>
</div>


<script>
    katex.render("\\frac{\\partial C_{0}}{\\partial \\omega^{(L)}} = \\frac{\\partial C_{0}}{\\partial a^{(L)}}  \\frac{\\partial a^{(L)}}{\\partial z^{(L)}}  \\frac{\\partial z^{(L)}}{\\partial \\omega^{(L)}} " , from_eq_10_extend);

    katex.render("\\frac{\\partial C_{0}}{\\partial \\omega^{(L)}} =  2(a^{(L)} - y)  \\sigma'(z^{(L)})   a^{(L-1)}" , partial_C_to_omega_substitute);
</script>


<p>Since the cost can be thought as a function of weights and biases, the gradient of cost function of each training can be expressed in partial derivative of all weightes and biases. Thus we can present it as a vector matrix.</p>

<div class="eq">
        <span  class="eq-expression katex" id="grad_C_in_matrix" ></span>
        <span class="eq-no">Eq (12)</span>
</div>


<script>
   katex.render("\\nabla C=\\begin{bmatrix}  \\frac{\\partial C}{\\partial \\omega^{(1)}} \\\\  \\\\ \\frac{\\partial C}{\\partial b^{(1)}} \\\\ \\\\ \\vdots \\\\ \\\\  \\frac{\\partial C}{\\partial \\omega^{(L)}} \\\\ \\\\  \\frac{\\partial C}{\\partial b^{(L)}} \\\\  \\end{bmatrix}", grad_C_in_matrix);
</script>


<p>The sensitivity of cost function to weight can be extended to analyze sensitivity of cost function to bias.</p>

<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_bias_chain" ></span>
        <span class="eq-no">Eq (13)</span>
</div>


<script>
    katex.render("\\frac{\\partial C_{0}}{\\partial b^{(L)}} = \\frac{\\partial C_{0}}{\\partial a^{(L)}}  \\frac{\\partial a^{(L)}}{\\partial z^{(L)}}  \\frac{\\partial z^{(L)}}{\\partial b^{(L)}} " , partial_C_to_bias_chain);
</script>


<p>From Equation (8):</p>

<div class="eq">
        <span  class="eq-expression katex" id="partial_Z_to_bias" ></span>
</div>


<script>
    katex.render("\\frac{\\partial z^{(L)}}{\\partial b^{(L)}} = 1" , partial_Z_to_bias);
</script>


<p>Thus,</p>

<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_bias_chain_2" ></span> <br/><br/>
        <span  class="eq-expression katex" id="partial_C_to_bias_substitute" ></span>
</div>


<script>
    katex.render("\\frac{\\partial C_{0}}{\\partial b^{(L)}} = \\frac{\\partial C_{0}}{\\partial a^{(L)}}  \\frac{\\partial a^{(L)}}{\\partial z^{(L)}}  \\frac{\\partial z^{(L)}}{\\partial b^{(L)}} " , partial_C_to_bias_chain_2);

    katex.render("\\frac{\\partial C_{0}}{\\partial b^{(L)}} = 2 (a^{(L)} - y) \\cdot \\sigma'(z^{(L)}) \\cdot 1 " , partial_C_to_bias_substitute);

</script>


<p><br/></p>

<p>To get a more comprehensive neuron connection, Figure 7 denotes ANN with a more detailed subscript and superscript that show index neuron order and layer.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-neuron-relation-with-index.png" width="60%" height="60%"></p>

<center><small>Figure 7: ANN with indexed neurons<br/>
        </small>
</center>


<p><br/></p>

<div class="eq">
        <span  class="eq-expression katex" id="z_jL" ></span>
</div>


<script>
    katex.render("z_j^{(L)} = \\omega_{j0}^{(L)}a_0^{(L-1)} + \\omega_{j1}^{(L)}a_1^{(L-1)} + \\omega_{j2}^{(L)}a_2^{(L-1)} + b_j^{(L)}" , z_jL);
</script>


<p>So that,</p>

<div class="eq">
        <span  class="eq-expression katex" id="a_jL_function_activation" ></span>
</div>


<script>
    katex.render("a_j^{(L)} = \\sigma( z_j^{(L)})" , a_jL_function_activation);
</script>


<p>Figure 7 shows that  <span  class="eq-expression katex" id="a_k_01" ></span> impacts the value of <span  class="eq-expression katex" id="a_k_02" ></span> and <span  class="eq-expression katex" id="a_k_03" ></span>. Thus, the rate of changes <span  class="eq-expression katex" id="C_0" ></span> to <span  class="eq-expression katex" id="a_k_01_a" ></span> is evaluated as (sum over layer L):</p>

<div class="eq">
        <span  class="eq-expression katex" id="partial_C_ak_sum_L_layer" ></span>
        <span class="eq-no">Eq (14)</span>
</div>


<script>
    katex.render("\\frac{\\partial C_0}{\\partial a_k^{(L-1)}} = \\sum_{j=0}^{L-1} \\frac{\\partial C_0}{\\partial a_j^{(L)}} \\frac{\\partial a_j^{(L)}}{\\partial z_j^{(L)}} \\frac{\\partial z_j^{(L)}}{\\partial a_k^{(L-1)}}" , partial_C_ak_sum_L_layer);
</script>


<p>Generally, Equation (11) can be written in a fully indexed notation as:</p>

<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_omega_jk" ></span>
</div>


<script>
    katex.render("\\frac{\\partial C}{\\partial \\omega_{jk}^{(L)}} = \\frac{\\partial C}{\\partial a_j^{(L)}} \\frac{\\partial a_j^{(L)}}{\\partial z_j^{(L)}} \\frac{\\partial z_j^{(L)}}{\\partial \\omega_{jk}^{(L)}}" , partial_C_to_omega_jk);
</script>




<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_omega_jk_substitute" ></span>
        <span class="eq-no">Eq (15)</span>
</div>


<script>
    katex.render("\\frac{\\partial C}{\\partial \\omega_{jk}^{(L)}} = \\frac{\\partial C}{\\partial a_j^{(L)}}  \\sigma'(z_j^{(L)}) a_k^{(L-1)}" , partial_C_to_omega_jk_substitute);
</script>


<p>Component <span  class="eq-expression katex" id="symbol_partial_C_to_omega_jk" ></span> of Equation (15) can be evaluated using the same approach as Equation (14)</p>

<script>
    katex.render(" \\frac{\\partial C}{\\partial a_j^{(L)}}" , symbol_partial_C_to_omega_jk);
</script>




<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_omega_jk_sum_all_layer_L" ></span>
</div>


<script>
    katex.render("\\frac{\\partial C}{\\partial a_j^{(L)}} = \\sum_{j=0}^{(L+1) -1} \\lbrack \\frac{\\partial C}{a_j^{(L+1)}} \\rbrack  \\lbrack \\sigma'(z_j^{(L+1)}) \\rbrack \\lbrack \\omega_j^{(L+1)} \\rbrack" , partial_C_to_omega_jk_sum_all_layer_L);
</script>


<p>If the cost function <span  class="eq-expression katex" id="C_def" ></span> defined as <span  class="eq-expression katex" id="C_def_1" ></span>, then</p>

<div class="eq">
        <span  class="eq-expression katex" id="partial_C_to_omega_j_last_layer" ></span>
</div>


<script>
    katex.render("\\frac{\\partial C}{\\partial a_j^{(L)}} = 2(a_j^{(L)} - y_j)" , partial_C_to_omega_j_last_layer);
</script>




<script>
    katex.render("\\omega", omega1);
    katex.render("\\Sigma", sigma1);

    katex.render("a_k^{(L-1)}", a_k_01);
    katex.render("a_k^{(L-1)}", a_k_01_a);
    katex.render("a_0^{(L)}", a_k_02);
    katex.render("a_1^{(L)}", a_k_03);

    katex.render("z^{(L)}", a_z_0);
    katex.render("C_0", C_0);

    katex.render("C", C_def);
    katex.render("(a_j^{(L)} - y_j)^2", C_def_1);
    katex.render("\\frac{\\partial C}{\\partial a_j^{(L)}} ", C_to_aj);

</script>


<h1>Numerical Computation</h1>

<p>To complement the explanation about neural networks, in this post we will use an example provided by <a href="https://machinelearning.tobiashill.se/part-2-gradient-descent-and-backpropagation/">Tobias Hill</a> with a slight modification in notation to meet our notation convention in the previous chapter. The neural network structure showed in Figure 7.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-04-06-nn-numerical.png" width="80%" height="80%"></p>

<center><small>Figure 7: Neural network with numeric attributes<br/>
        </small>
</center>


<p><br/></p>

<p>The activation function we use is sigmoid, and the learning rate of <span  class="eq-expression katex" id="eta_0_point_1" ></span></p>

<div class="eq">
        <span  class="eq-expression katex" id="sigmoid_func" ></span>
        <span class="eq-no">Eq (16)</span>
</div>


<script>
    katex.render("\\sigma(z) = \\frac{1}{1+e^{-z}}" , sigmoid_func);
    katex.render("\\eta = 0.1" , eta_0_point_1);
</script>




<div class="eq">
        <span  class="eq-expression katex" id="sigmoid_derivative" ></span>
        <span class="eq-no">Eq (17)</span>
</div>


<script>
    katex.render("\\sigma'(z) = \\sigma(z)(1 - \\sigma(z))" , sigmoid_derivative);
</script>


<p>The cost function of the ANN is evaluated with Equation (1).</p>

<h2>Feed Forward</h2>

<p>First of all, Let&rsquo;s evaluate output of neuron by implmenting sigmoid activation fuction as showed in Equation (16).</p>

<div class="">
        <span  class="eq-expression katex" id="eq_ff" ></span> <br/>
        <span  class="eq-expression katex" id="eq_ff_h1" ></span> <br/>
        <span  class="eq-expression katex" id="eq_ff_h2" ></span> <br/>
        <span  class="eq-expression katex" id="eq_ff_a1" ></span> <br/>
        <span  class="eq-expression katex" id="eq_ff_a2" ></span>
</div>


<p></p>

<script>
    katex.render("h_1 = \\sigma(0.3 \\cdot 2 + (-0.4)\\cdot 3 + 0.25) = 0.41338242108267" , eq_ff_h1);
    katex.render("h_2 = \\sigma(0.2 \\cdot 2 + 0.6 \\cdot 3 + 0.45) = 0.934010990508781s" , eq_ff_h2);
    katex.render("a_1 = \\sigma(0.7 \\cdot h_1 + 0.5 \\cdot h_2 + 0.15) = 0.712257432295742" , eq_ff_a1);
    katex.render("a_2 = \\sigma((-0.3) \\cdot h_1 + (-0.1) \\cdot h_2 + 0.35) = 0.533097573871501" , eq_ff_a2);
    
</script>


<p>The result and expected values of the ANN can expressed as matrix vector.</p>

<div class="eq">
        <span  class="eq-expression katex" id="eq_ff_expected" ></span> <br/>
        <span  class="eq-expression katex" id="eq_ff_output" ></span>
        
</div>


<script>
        katex.render("Expected (y) =\\begin{bmatrix}  1.0 \\\\  \\\\ 0.2 \\\\  \\end{bmatrix}", eq_ff_expected);
        katex.render("Output (a) =\\begin{bmatrix}  0.712257432295742 \\\\  \\\\ 0.533097573871501 \\\\  \\end{bmatrix}", eq_ff_output);

   
</script>


<p>The total cost of first feed to the ANN is evaluated with Equation (2):</p>

<div class="">
        <span  class="eq-expression katex" id="eq_ff_cost_0" ></span> <br/>
        <span  class="eq-expression katex" id="eq_ff_cost_1" ></span> <br/>
</div>


<script>
        katex.render("C = (1-0.712257432295742)^2 + (0.2-0.533097573871501)^2", eq_ff_cost_0);
        katex.render("C = 0.19374977898811957", eq_ff_cost_1);
</script>


<p><br/>
Equation (2) shows that <span  class="eq-expression katex" id="cost_1" ></span> is essentially a function of <span  class="eq-expression katex" id="func_of_expected_actual" ></span> or <span  class="eq-expression katex" id="func_of_weight_bias_act_z_x_y" ></span></p>

<script>
        katex.render("C", cost_1);
        katex.render("C(y,a)", func_of_expected_actual);
        katex.render("C(\\omega, b, \\sigma, z, x, y)", func_of_weight_bias_act_z_x_y);
</script>


<h2>Back Propagation</h2>

<h3 style="color: #2292A7;"> Weight of <span  class="eq-expression katex" id="omega_5" ></span> </h3>


<div>
        <span  class="eq-expression katex" id="cost_all"  ></span> <br/>
        <span  class="eq-expression katex" id="a1_back"  ></span> <br/>
        <span  class="eq-expression katex" id="z1_back"  ></span> <br/>

        <br/>
        <span  class="eq-expression katex" id="partial_dir_C_to_a1"  ></span> <br/>
        <span  class="eq-expression katex" id="partial_dir_a1_to_z1"  ></span> <br/>
        <span  class="eq-expression katex" id="partial_dir_z1_to_omega5"  ></span>
</div>


<p><br/>
Thus,</p>

<p><span  class="eq-expression katex" id="partial_dir_cost_to_omega5"  ></span> <br/><br/>
<span  class="eq-expression katex" id="weight_5_update" ></span> <br/></p>

<p>By using the same method, we can evaluate the update the other weights and biases in the last layer.
<br/>
<span  class="eq-expression katex" id="weight_6_update" ></span> <br/>
<span  class="eq-expression katex" id="weight_7_update" ></span> <br/>
<span  class="eq-expression katex" id="weight_8_update" ></span> <br/></p>

<p>To update bias, we use the similar way as updating weight.
<span  class="eq-expression katex" id="partial_dir_cost_to_bias3"  ></span> <br/><br/></p>

<p><span  class="eq-expression katex" id="bias_3_update" ></span> <br/>
<span  class="eq-expression katex" id="bias_4_update" ></span> <br/></p>

<script>
        katex.render("\\omega_5", omega_5);
        katex.render("C = (a_1 - y_1)^2 + (a_2 - y_2)^2", cost_all);
        katex.render("a_1 = \\sigma(z_{a_1})", a1_back);
        katex.render("z_{a_1} = b_3 + \\omega_5 \\cdot h_1 + \\omega_7 \\cdot h_2", z1_back);

        katex.render("\\frac{\\partial C}{\\partial a_1} = 2(a_1 - y_1) = -0.5754851354085166", partial_dir_C_to_a1);
        katex.render("\\frac{\\partial a_1}{\\partial z_{a_1}} = \\sigma'(z_{a_1}) = 0.220793265944315", partial_dir_a1_to_z1);
        katex.render("\\frac{\\partial z_{a_1}}{\\partial \\omega_5} = h_1 = 0.41338242108267", partial_dir_z1_to_omega5);

       
        katex.render("\\frac{\\partial C}{\\partial \\omega_5} = \\frac{\\partial C}{\\partial a_1} \\frac{\\partial a_1}{\\partial z_{a_1}} \\frac{\\partial z_{a_1}}{\\partial \\omega_5} = -0.052525710835624", partial_dir_cost_to_omega5);
        
        katex.render("\\therefore \\omega_5^{+} = \\omega_5 - \\eta \\frac{\\partial C}{\\partial \\omega_5} = 0.70525257108356", weight_5_update);

        katex.render("\\omega_6^{+}  = -0.3064179482696209", weight_6_update);
        katex.render("\\omega_7^{+}  = 0.511867846503068", weight_7_update);
        katex.render("\\omega_8^{+}  = -0.511867846503068", weight_8_update);

        katex.render("\\frac{\\partial C}{\\partial b_3} = \\frac{\\partial C}{\\partial a_1} \\frac{\\partial a_1}{\\partial z_{a_1}} \\frac{\\partial z_{a_1}}{\\partial b_3}", partial_dir_cost_to_bias3);

        

        katex.render("b_3^{+}  = 0.1627063242549253", bias_3_update);
        katex.render("b_4^{+}  = 0.33447454961240974", bias_4_update);

</script>




<h3 style="color: #2292A7;"> Weight of <span  class="eq-expression katex" id="omega_1" ></span> </h3>


<p><span  class="eq-expression katex" id="z_h1"  ></span> <br/>
<span  class="eq-expression katex" id="h1"  ></span> <br/><br/></p>

<p><span  class="eq-expression katex" id="partial_c_to_za1"  ></span> <br/><br/>
<span  class="eq-expression katex" id="partial_c_to_za2"  ></span> <br/></p>

<p><br/></p>

<p><span  class="eq-expression katex" id="partial_dir_cost_to_omega1"  ></span> <br/><br/>
<span  class="eq-expression katex" id="partial_dir_cost_to_omega1_elaborate1"  ></span> <br/><br/>
<span  class="eq-expression katex" id="partial_dir_cost_to_omega1_elaborate2"  ></span> <br/><br/>
<span  class="eq-expression katex" id="partial_dir_cost_to_omega1_elaborate3"  ></span> <br/><br/></p>

<p><span  class="eq-expression katex" id="weight_1_update" ></span> <br/></p>

<script>
        katex.render("\\omega_1", omega_1);

        katex.render("z_{h_1} = b_1 + x_1 \\cdot \\omega_1 + x_2 \\cdot \\omega_3", z_h1);
        katex.render("h_1 = \\sigma(z_{h_1})", h1);

        katex.render("\\frac{\\partial C}{\\partial z_{a_1}} = \\frac{\\partial C}{\\partial a_1} \\frac{\\partial a_1}{\\partial z_{a_1}} = 2 (a_1 - y_1) \\sigma'(z_{a_1})", partial_c_to_za1);

        katex.render("\\frac{\\partial C}{\\partial z_{a_2}} = \\frac{\\partial C}{\\partial a_2} \\frac{\\partial a_2}{\\partial z_{a_2}} = 2 (a_2 - y_2) \\sigma'(z_{a_2})", partial_c_to_za2);


        katex.render("\\frac{\\partial C}{\\partial \\omega_1} =\\frac{\\partial ( C_{a_1} + C_{a_1})}{\\partial h_1} \\frac{\\partial h_1}{\\partial z_{h_{1}}} \\frac{\\partial z_{h_{1}}}{\\partial \\omega_1} = \\lbrack \\frac{\\partial C_{a_1}}{\\partial h_1} + \\frac{\\partial C_{a_2}}{\\partial h_1} \\rbrack \\frac{\\partial h_1}{\\partial z_{h_{1}}} \\frac{\\partial z_{h_{1}}}{\\partial \\omega_1}", partial_dir_cost_to_omega1);

        katex.render("\\space \\space \\space \\space \\space \\space = \\lbrack \\frac{\\partial C_{a_1}}{\\partial h_1} + \\frac{\\partial C_{a_2}}{\\partial h_1} \\rbrack \\frac{\\partial h_1}{\\partial z_{h_{1}}} \\frac{\\partial z_{h_{1}}}{\\partial \\omega_1}", partial_dir_cost_to_omega1_elaborate1);

        katex.render("\\space \\space \\space \\space \\space \\space = \\lbrack \\frac{\\partial C}{\\partial z_{a_1}} \\frac{\\partial z_{a_1}}{\\partial h_1} + \\frac{\\partial C}{\\partial z_{a_1}} \\frac{\\partial z_{a_1}}{\\partial h_1} \\rbrack \\frac{\\partial h_1}{\\partial z_{h_{1}}} \\frac{\\partial z_{h_{1}}}{\\partial \\omega_1}", partial_dir_cost_to_omega1_elaborate2);

        katex.render("\\space \\space \\space \\space \\space \\space = \\lbrack \\frac{\\partial C}{\\partial z_{a_1}} \\omega_5 + \\frac{\\partial C}{\\partial z_{a_1}} \\omega_6 \\rbrack \\sigma'(z_{h_1}) x_1 = -0.064945998937865", partial_dir_cost_to_omega1_elaborate3);

        katex.render("\\therefore \\omega_1^{+} = \\omega_1 - \\eta \\frac{\\partial C}{\\partial \\omega_1} = 0.3064945998937866", weight_1_update);
</script>


<h1>References</h1>

<ol>
<li><a href="https://www.investopedia.com/terms/n/neuralnetwork.asp">Neural Network, James Chen</a></li>
<li><a href="https://machinelearning.tobiashill.se/part-2-gradient-descent-and-backpropagation/">Gradient Descent and Backpropagation, Tobias Hill</a></li>
<li><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/">How to Code a Neural Network with Backpropagation In Python (from scratch), Jason Brownlee</a></li>
<li><a href="https://www.youtube.com/watch?v=tIeHLnjs5U8&amp;ab_channel=3Blue1Brown">Backpropagation calculus-Deep learning, 3Blue1Brown</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Domain Driven Design Short Summary]]></title>
    <link href="http://neutrofoton.github.io/blog/2021/03/20/domain-driven-design-short-summary/"/>
    <updated>2021-03-20T15:49:56+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2021/03/20/domain-driven-design-short-summary</id>
    <content type="html"><![CDATA[<p>I believe there are tons of articles and books out there that discuss about Domain Driven Design (DDD for short). This post essentially is taken from my note archieved when I explored about DDD from several resources. I rewrite it in here as a refresh for myself mainly.</p>

<p>Domain Driven Design (DDD) is the concept that the structure and language of software code (class names, class methods, class variables) should match the business domain[1].  We don&rsquo;t need to kill a mosquito with a cannon. We need to choose the fittest method in solving a problem. As well as DDD, it is not always be a fit method in solving application design. A software application has several attributes. Some of them deal with[3]:</p>

<ul>
<li>Amount of Data</li>
<li>Performance</li>
<li>Business Logic complexity</li>
<li>Tehnical Complexity.</li>
</ul>


<p>From the fourth software attributes, DDD is the most suitable with an application that has a <em>complex business logic</em>. DDD is designed to tackle the complexity of business rules. The main goals of DDD are[1]:</p>

<ul>
<li>Placing the project&rsquo;s primary focus on the core domain and domain logic;</li>
<li>Basing complex designs on a model of the domain;</li>
<li>Initiating a creative collaboration between technical and domain experts to iteratively refine a conceptual model that addresses particular domain problems.</li>
</ul>


<p>One of good resources about DDD is <a href="https://www.pluralsight.com/courses/domain-driven-design-in-practice">DDD course by Vladimir Khorikov</a>. I also cited a few/snippet code from his course to make my summary about DDD more clearer to understand.</p>

<h1>Terms in DDD</h1>

<h2>Ubiquitous Languange</h2>

<p><em>Ubiquitous Languanges</em> brides the gab between developer and business expert/ domain expert/ subject matter expert (SME). The <em>Ubiquitous Languange</em> notion come up to avoid misunderstanding between them. For example, the developer has a class <code>Product</code> that represent business term <em>Product</em> (both product and package). On the other hand the business expert treat <em>Product</em> and <em>Package</em> as different things. By the condition, it is needed the same languange to avoid misunderstanding.</p>

<h2>Bounded Context</h2>

<p>Bounded Context is a central pattern in DDD. It is the focus of DDD&rsquo;s strategic design section which is all about dealing with large models and teams. DDD deals with large models by dividing them into different <em>Bounded Contexts</em> and being explicit about their interrelationships [Martin Fowler][8].</p>

<p><em>Bounded Context</em> notion comes up to make clear boundries between different parts of the system. Let&rsquo;s say our system consist of <em>Sales</em> and <em>Support</em>, we can seperate Product into <em>Sales</em> and <em>Support</em> context to make clear boundries between the two.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-03-20-fig00.png"></p>

<center><small>Figure 1: Bounded Contexts <br/>
        Source: https://martinfowler.com/bliki/BoundedContext.html</small>
</center>




<p><p/></p>

<p>Figure 1 shows that <em>Bounded Context</em> aims for separating the model and explicitly drawn the boundaries between pieces. The reason for context separation is that as the application grows, it becomes harder to maintain a single unified model as it becomes larger and more people get involved in the development process.</p>

<h2>Sub Domain</h2>

<p>The difference between <em>Sub Domain</em> and <em>Bounded Context</em> is that the <em>Sub Domain</em> is a <em>Problem Space</em>. Meanwhile <em>Bounded Context</em> is a <em>Solution Space</em>. <em>Sub Domain</em> and <em>Bounded Context</em> have a <strong>1-to-1</strong> relation. It means that a <em>Sub Domain</em> should be covered with exactly a <em>Bounded Context</em>.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-03-20-fig03.png"></p>

<p><center><small>Figure 2: Sub Domain - Bounded Contexts</small>
</center></p>

<p>Since <em>Sub Domain</em> is a <em>Problem Space</em>, it should be defined by <em>Business Expert</em> or <em>Domain Experts</em>. The <em>Sub Domain</em> topic usually will come up when we have a talk with the <em>Domain Expert</em> while gathering requirement.</p>

<h2>Core Domain</h2>

<p>The notion that focuses on <em>Domain Model</em> which is the most important part of the system.</p>

<h1>Onion Architecture</h1>

<p>The implementation of DDD in onion architecture[3][5][6] showed in the Figure 3.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-03-20-fig01.png"></p>

<p><center>
    <small>Figure 3: DDD in onion architecture </small>
</center>
<br/></p>

<p>Figure 3 shows that the core of the architecture is the <em>Domain Model</em>. The <em>Domain Model</em> is isolated from others for seperation of consern purpose. It consists of <em>Entities, Value Objects, Domain Events,</em> and <em>Agregates</em>. They are most important part in DDD since they represent business logic implementation.</p>

<p>The outer layer in the onion architecture depends on the inner one. The inner layer is isolated from the outer layer that make the inner layer does not know the outer one. Figure 3 denotes that the <em>Domain Model</em> does not know how it is peristed to database. Since persisting model to database is handled by <em>Repository</em> on the outer layer.</p>

<h1>Testing in TDD</h1>

<p><em>Unit Test</em> is one of important part in software development. Test coverage that reaches 100% has high effort. In practice the most important that should cover most unit test is the code base <em>(Domain Model)</em> at the inner most layer in the onion architecture. The closer to 100%, the better the <em>Unit Test</em> coverage will be. Meanwhile for the outer layer, the test schenario could be coveraged by integration test.</p>

<h1>Entity vs Value Object</h1>

<p>The difference between Entity and Value Object can be identified from several ways:</p>

<ul>
<li>Type of Equality</li>
<li>Immutability</li>
<li>Lifespan</li>
</ul>


<h2>1. Type of equality</h2>

<p><em>Type Equality</em> is applied to the objects which have the same type. It is classified into 3 categories:</p>

<ul>
<li><p><em>Identifier Equality</em><br/>
Two objects A and B are identified have <em>Identifier Equality</em> if they have the same <em>Id</em>.</p></li>
<li><p><em>Reference Equality</em><br/>
Two objects A and B are identified have <em>Reference Equality</em> if they point to the same <em>memory address</em>.</p></li>
<li><p><em>Structural Equality</em><br/>
Two objects A and B are identified have <em>Structural Equality</em> if <em>all the member values are matched</em>.</p></li>
</ul>


<p>The 3 types of Type Equality is summarized in the following Figure.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2021-03-20-fig02.png"></p>

<p><center><small>Figure 4: Type Equality classification</small>
</center></p>

<p><em>Identifier Equality</em> usually referes to <em>Entity</em>. Meanwhile <em>Structural Equality</em> refers to <em>Value Object</em>. The <em>Reference Equality</em> can be applied to <em>Entity</em> or <em>Value Object</em>. In practice, <em>Value Object</em> does not has an Id.</p>

<h2>2. Immutability</h2>

<p>The characteristic of <em>Entity</em>:</p>

<ul>
<li>Having identity <em>Id</em></li>
<li>Mutable</li>
</ul>


<p>The characteristic of <em>Value Object</em>:</p>

<ul>
<li>Having no identity <em>Id</em></li>
<li>Immutable</li>
</ul>


<h2>3. Lifespan</h2>

<p>From the lifespan point of view, <em>Value Object</em> can not live by its own. It can be owned by one or several identities.
For example <code>Address</code> object can not stay by its own. It should be belonged to <code>Person</code> object. From persistance perspective, <em>Value Object</em> does not have its own table in database.</p>

<h1>How to Recognize Entity or Value Object</h1>

<p>It is not always clear having specific characteristic if a term or notion in a business process is an <em>Entity</em> or <em>Value Object</em>. It depends on the business process itself. A good approach to identify whether a notion of object is an <em>Entity</em> or <em>Value Object</em> is by comparing to <em>integer</em>[3].</p>

<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">//Integer</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">MethodA</span><span class="p">(){</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">value1</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">value2</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//Value Object</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">MethodB</span><span class="p">(){</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//money1 and money2 essentially the same. </span>
</span><span class='line'>    <span class="c1">//since they have the same nominal in business process context.</span>
</span><span class='line'>    <span class="c1">//programmatically they both have the same structure equality</span>
</span><span class='line'>    <span class="n">Money</span> <span class="n">money1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Money</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>    <span class="n">Money</span> <span class="n">money2</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Money</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Ideally most business logic elements are identified as <em>Value Objects</em>. The <em>Entity</em> act as a wrapper of <em>Value Object(s)</em>. However, don&rsquo;t hesitate to refactor <em>Value Object</em> to <em>Entity</em> or vise versa if we identify it should be.</p>

<p><figure class='code'><figcaption><span>Entity Base Class</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Entity</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">virtual</span> <span class="kt">long</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">protected</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">Equals</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">other</span> <span class="p">=</span> <span class="n">obj</span> <span class="k">as</span> <span class="n">Entity</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">GetRealType</span><span class="p">()</span> <span class="p">!=</span> <span class="n">other</span><span class="p">.</span><span class="n">GetRealType</span><span class="p">())</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">Id</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">other</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">Id</span> <span class="p">==</span> <span class="n">other</span><span class="p">.</span><span class="n">Id</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="p">==(</span><span class="n">Entity</span> <span class="n">a</span><span class="p">,</span> <span class="n">Entity</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="p">||</span> <span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="p">!=(</span><span class="n">Entity</span> <span class="n">a</span><span class="p">,</span> <span class="n">Entity</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">!(</span><span class="n">a</span> <span class="p">==</span> <span class="n">b</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="kt">int</span> <span class="nf">GetHashCode</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">(</span><span class="n">GetRealType</span><span class="p">().</span><span class="n">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="n">Id</span><span class="p">).</span><span class="n">GetHashCode</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="n">Type</span> <span class="nf">GetRealType</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">NHibernateProxyHelper</span><span class="p">.</span><span class="n">GetClassWithoutInitializingProxy</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><figcaption><span>Value Object base class</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">ValueObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="n">ValueObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">Equals</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">valueObject</span> <span class="p">=</span> <span class="n">obj</span> <span class="k">as</span> <span class="n">T</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">valueObject</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="nf">EqualsCore</span><span class="p">(</span><span class="n">valueObject</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">protected</span> <span class="k">abstract</span> <span class="kt">bool</span> <span class="nf">EqualsCore</span><span class="p">(</span><span class="n">T</span> <span class="n">other</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="kt">int</span> <span class="nf">GetHashCode</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nf">GetHashCodeCore</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">protected</span> <span class="k">abstract</span> <span class="kt">int</span> <span class="nf">GetHashCodeCore</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="p">==(</span><span class="n">ValueObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">ValueObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="p">||</span> <span class="n">ReferenceEquals</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="p">!=(</span><span class="n">ValueObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">ValueObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">!(</span><span class="n">a</span> <span class="p">==</span> <span class="n">b</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<h1>Agregate</h1>

<p><em>Aggregate</em> is a pattern in DDD. It is a cluster of domain objects that can be treated as a single unit[7]. <em>Aggregate</em> is an encapsulation of <em>Entities</em> and/or <em>Value Objects</em> (domain objects). An <em>Entity</em> can belong to a single <em>Agregate</em> only. Meanwhile a <em>Value Object</em> can belong to multiple <em>Agregates</em>.</p>

<p>An <em>Agregate</em> contains a set of operations which those domain objects can be operated on. An <em>Agregate</em> also act as a single operation unit. Application layer should reload it from database, then perform action and store it back as a single object. Hence, the <em>Agregate</em> should not be too large. Commonly it contains maximum 3 <em>Entities</em>. On the contrary to <em>Entity</em>, we can have as many <em>Value Objects</em> in an <em>Agregate</em> as we want.</p>

<p><figure class='code'><figcaption><span>Agregate Root</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">AggregateRoot</span> <span class="p">:</span> <span class="n">Entity</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><figcaption><span>Repository for Database Operation</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Repository</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="n">AggregateRoot</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">T</span> <span class="nf">GetById</span><span class="p">(</span><span class="kt">long</span> <span class="n">id</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">&quot;load data from database&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">Save</span><span class="p">(</span><span class="n">T</span> <span class="n">aggregateRoot</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">&quot;operation insert to database&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Domain Event</h2>

<p><em>Domain Event</em> represents an event that&rsquo;s significant to the <em>Domain Model</em>. It&rsquo;s important to distinguish <em>Domain Event</em> to <em>System Event</em>. <em>System Event</em> deals with infrastructure event such as button click, timer tick, window close etc. On the other hand, <em>Domain Event</em> describe occasion which is important to the <em>Domain</em>. For example, when a button clicked <em>(System Event)</em>, it calls a domain operation. Domain operation trigger an event to change balance values in other <em>Bounded Context</em> for example head office.</p>

<p><em>Domain Event</em> is often used to[3]:</p>

<ul>
<li>Decouple <em>Bounded Context</em></li>
<li>Facilitate communication between <em>Bounded Context</em></li>
<li>Decouple <em>Entities</em> within a <em>Bounded Context</em></li>
</ul>


<p>The guidelines in implementing <em>Domain Event</em> are[3]:</p>

<ul>
<li>Naming should be in <em>Past Tense</em>. Example: <code>BalanceChangedEvent</code></li>
<li>Passing data as small/little as possible. Don&rsquo;t pass data/information more than needed.</li>
<li>We should not pass <em>Entity</em> to an <em>Event</em>. Since it will produce additonal point of coupling. We should use primitive data type instead.</li>
</ul>


<h1>References</h1>

<ol>
<li><a href="https://en.wikipedia.org/wiki/Domain-driven_design">https://en.wikipedia.org/wiki/Domain-driven_design</a></li>
<li><a href="https://www.amazon.com/gp/product/0321125215">Domain Driven Design: Tackling Complexity in the Heart of Software</a></li>
<li><a href="https://www.pluralsight.com/courses/domain-driven-design-in-practice">https://www.pluralsight.com/courses/domain-driven-design-in-practice</a></li>
<li><a href="https://www.baeldung.com/spring-data-ddd">https://www.baeldung.com/spring-data-ddd</a></li>
<li><a href="https://www.baeldung.com/spring-boot-clean-architecture">https://www.baeldung.com/spring-boot-clean-architecture</a></li>
<li><a href="https://jeffreypalermo.com/2008/07/the-onion-architecture-part-1/">https://jeffreypalermo.com/2008/07/the-onion-architecture-part-1/</a></li>
<li><a href="https://martinfowler.com/bliki/DDD_Aggregate.html">https://martinfowler.com/bliki/DDD_Aggregate.html</a></li>
<li><a href="https://martinfowler.com/bliki/BoundedContext.html">https://martinfowler.com/bliki/BoundedContext.html</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Generate POJO and Hibernate Mapping Using Hibernate Tools]]></title>
    <link href="http://neutrofoton.github.io/blog/2020/11/30/generate-pojo-and-hibernate-mapping-using-hibernate-tools/"/>
    <updated>2020-11-30T18:13:54+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2020/11/30/generate-pojo-and-hibernate-mapping-using-hibernate-tools</id>
    <content type="html"><![CDATA[<p>Sometime we get into a condition in which we need to create POJO classes from an existing database. It could  take time if the database has many tables. Instead of manually create them, we could use <a href="https://docs.jboss.org/tools/4.1.0.Final/en/hibernatetools/html_single/index.html">Hibernate Tool</a>. Hibernate Tools is an eclipse plugin that can be installed from the eclipse marketplace.</p>

<p>In this post, we use Spring Tool Suite (STS) 4 instead of directly use the eclipse version of the IDE. Meanwhile the database we use is PostgreSQL. It should be applicable to any other database.</p>

<p>The steps of using Hibernate Tools is summarized as follow.
I append many screenshots on this post in order the steps are easier to follow.</p>

<h4>Step 1 : Install Hibernate Tools plugin</h4>

<p>To install Hibernate Tools plugin, go to menu <code> Help > Eclipse Marketplace </code>.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig01.png"></p>

<p>Enter <code>Hibernate Tools</code> in the search field.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig02.png"></p>

<p>Follow the installation step until the installation success and finish. Eclipse will show us a pop up message to restart it once the installation finished.</p>

<h4>Step 2 : Create Java Maven project</h4>

<p>Before building a connection to the database, we will create a maven project that contains a hibernate configuration file and where the generated code will be placed. The following figures show the maven project configuration setting.</p>

<p>First, ensure we are in the <code>Java persepective</code> mode. From the menu <code>File > New > Other&hellip;</code> select <code>Maven Project</code> as the following figure.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig03.png"></p>

<p>Select the checked box of <code>Create a simple project</code> then press <code>Next</code>.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig04.png"></p>

<p>Fill the <code>Group Id</code> and <code>Artifact Id</code>. Select <code>jar</code> for the <code>Packaging</code> option, then click <code>Finish</code></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig05.png"></p>

<p>Create a namespace in the maven project where the generated code will be placed.
<img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig06.png"></p>

<p>The project structure should look like the following picture.
<img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig07.png"></p>

<p>Once the project skeleton constructued, edit the <code>pom.xml</code> by adding dependencies of the hibernate and database driver. The latest jar version could be found in <a href="https://mvnrepository.com/">Maven Repository</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span><span class='line'>  <span class="nt">&lt;groupId&gt;</span>io.neutrofoton.lab<span class="nt">&lt;/groupId&gt;</span>
</span><span class='line'>  <span class="nt">&lt;artifactId&gt;</span>hibernatereverse<span class="nt">&lt;/artifactId&gt;</span>
</span><span class='line'>  <span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>
</span><span class='line'> <span class="nt">&lt;dependencies&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;dependency&gt;</span>
</span><span class='line'>      <span class="nt">&lt;groupId&gt;</span>org.hibernate<span class="nt">&lt;/groupId&gt;</span>
</span><span class='line'>      <span class="nt">&lt;artifactId&gt;</span>hibernate-core<span class="nt">&lt;/artifactId&gt;</span>
</span><span class='line'>      <span class="nt">&lt;version&gt;</span>5.4.24.Final<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/dependency&gt;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nt">&lt;dependency&gt;</span>
</span><span class='line'>      <span class="nt">&lt;groupId&gt;</span>org.postgresql<span class="nt">&lt;/groupId&gt;</span>
</span><span class='line'>      <span class="nt">&lt;artifactId&gt;</span>postgresql<span class="nt">&lt;/artifactId&gt;</span>
</span><span class='line'>      <span class="nt">&lt;version&gt;</span>42.2.18<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/dependency&gt;</span>
</span><span class='line'>      
</span><span class='line'>  
</span><span class='line'> <span class="nt">&lt;/dependencies&gt;</span>
</span><span class='line'><span class="nt">&lt;/project&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Step 3 : Create Hibernate configuration</h4>

<p>Before creating Hibernate configuration file, we need to switch to <code>Hibernate perspective</code> in the eclipse by opening menu <code>Window > Perspective > Open Perspective > Other&hellip;</code>. Then select <code>Hibernate</code> on the perspective list.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig08.png"></p>

<p>Once we are in the <code>Hibernate perspective</code>, we can create Hibernate configuration from menu <code>File > Hibernate Configuration File (*.cfg.xml)</code></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig09.png"></p>

<p>Placed the configuration file in the directory <code>src/main/java</code>, then click <code>Next</code>.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig10.png"></p>

<p>On the next dialog wizard, fill the configuration item according to our database specification. The database specification items to fill are database dialect, database driver, connection URL, default schema (if we want to generate for a specific schema, otherwise left it empty if we want to generate for all), username and password. On the dialog wizard, ensure to select the check box of <code>Create a console configuration</code> option.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig11.png"></p>

<p>In the <code>Hibernate Configurations</code> pane, the hibernate configuration that has been created should be listed in it. If the created hibernate configuration is not listed, press the <code>Refresh or Rebuild configuration</code> button in the top right corner of the pane. The generated Hibernate configuration should look like the following figure. We could expand the Database element on the Hibernate configuration to ensure we have a valid database connection.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig12.png"></p>

<h4>Step 4 : Run Hibernate code generation</h4>

<p>To run Hibernate code generation, ensure we select the active <code>Hibernate Configuration</code> in the Hibernate configuration pane. Then, open the menu of <code>Run > Hibernate Code Generation Configuration&hellip;</code></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig13.png"></p>

<p>In the <code>Hibernate Code Generation Configuration</code>, fill the package where the domain class will be in.
<img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig14.png"></p>

<p>In the <code>Exporter</code> tab, select <code>Use Java 5 syntax</code> and <code>Generate EJB3 annotations</code>. In the exporter list option, we can select items in the list that we need. In this post we only select <code>Domain code</code> that has annotation as Hibernate mapping. Finally click <code>Apply</code> and <code>Run</code> to generate the domain code.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig15.png"></p>

<h3>NOTES:</h3>

<p>If the annotation does not generated in the domain class, open the <code>Hibernate Configuration</code> and edit it. Then change the <code>Hibernate Version</code> to <code>5.2</code>. Finally run again as we have done on <strong>step 4</strong>.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig16.png"></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2020-11-30-fig17.png"></p>

<h1>References</h1>

<ol>
<li><a href="https://docs.jboss.org/tools/4.1.0.Final/en/hibernatetools/html_single/index.html">https://docs.jboss.org/tools/4.1.0.Final/en/hibernatetools/html_single/index.html</a></li>
<li><a href="https://stackoverflow.com/questions/50837574/annotation-not-created-when-generating-hibernate-mapping-files">https://stackoverflow.com/questions/50837574/annotation-not-created-when-generating-hibernate-mapping-files</a></li>
<li><a href="https://www.youtube.com/watch?v=KO_IdJbSJkI&amp;ab_channel=CodeJava">https://www.youtube.com/watch?v=KO_IdJbSJkI&amp;ab_channel=CodeJava</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PPTP on Ubuntu]]></title>
    <link href="http://neutrofoton.github.io/blog/2020/10/23/pptp-on-ubuntu/"/>
    <updated>2020-10-23T12:31:07+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2020/10/23/pptp-on-ubuntu</id>
    <content type="html"><![CDATA[<p>Previously, I have posted how to connect <a href="blog/2017/11/22/pptp-on-macos/"/>macOS to VPN server through PPTP protocol</a>. This post decribed how to do the same thing for Ubuntu. I used Ubuntu 18.04.3 LTS for testing.</p>

<p>The first step is installing PPTP client for Ubuntu.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get -y install pptp-linux
</span></code></pre></td></tr></table></div></figure>


<p>Create VPN configuration file</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo nano /etc/ppp/peers/myPPTP
</span></code></pre></td></tr></table></div></figure>


<p>paste the following script</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>pty <span class="s2">&quot;pptp IP_ADDRESS --nolaunchpppd --debug&quot;</span>
</span><span class='line'>name USERNAME
</span><span class='line'>password PASSWORD
</span><span class='line'>remotename PPTP
</span><span class='line'>require-mppe-128
</span><span class='line'>require-mschap-v2
</span><span class='line'>refuse-eap
</span><span class='line'>refuse-pap
</span><span class='line'>refuse-chap
</span><span class='line'>refuse-mschap
</span><span class='line'>noauth
</span><span class='line'>debug
</span><span class='line'>persist
</span><span class='line'>maxfail 0
</span><span class='line'>defaultroute
</span><span class='line'>replacedefaultroute
</span><span class='line'>usepeerdns
</span></code></pre></td></tr></table></div></figure>


<p>Then save and exit the file. Before executing VPN connection, change the file security attribute.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>chmod <span class="m">600</span>  /etc/ppp/peers/myPPTP
</span></code></pre></td></tr></table></div></figure>


<p>To connect to the VPN server, type the following command.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>pon myPPTP
</span></code></pre></td></tr></table></div></figure>


<p>To disconnect from the VPN server, run the following command.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>poff myPPTP
</span></code></pre></td></tr></table></div></figure>


<p>If you fail connect to the VPN server, please check the firewall configuration.</p>

<h1>References</h1>

<ol>
<li><a href="https://support.strongvpn.com/hc/en-us/articles/360003513553-PPTP-Setup-Debian-Ubuntu-Command-Line">https://support.strongvpn.com/hc/en-us/articles/360003513553-PPTP-Setup-Debian-Ubuntu-Command-Line</a></li>
<li><a href="https://www.networkinghowtos.com/howto/connect-to-a-pptp-vpn-server-from-ubuntu-linux/">https://www.networkinghowtos.com/howto/connect-to-a-pptp-vpn-server-from-ubuntu-linux/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Configure PHP and Virtual Host macOS High Sierra]]></title>
    <link href="http://neutrofoton.github.io/blog/2018/09/16/configure-php-and-virtual-host-macos-high-sierra/"/>
    <updated>2018-09-16T08:48:43+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2018/09/16/configure-php-and-virtual-host-macos-high-sierra</id>
    <content type="html"><![CDATA[<p>Apache is pre installed on macOS High Sierra. We just need to run its service with the following command to activate it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apachectl start
</span></code></pre></td></tr></table></div></figure>


<p>Then we just open <code><a href="http://localhost">http://localhost</a></code> via browser. Apache will display a default HTML page come with it.</p>

<h2>Activating PHP Module</h2>

<p>High Sierra also comes with PHP 7. So we don&rsquo;t need to install it manually. To activate PHP module</p>

<ol>
<li>Edit <code>/etc/apache2/httpd.conf</code></li>
<li>Uncomment / remove remark of
<code>#LoadModule php7_module libexec/apache2/libphp7.so</code></li>
<li>Save it and restart apache using
 <code>bash
     $ sudo apachectl restart
</code></li>
</ol>


<p>After applying the steps above, the php module should be activated and ready to use. In this post we will test it after configuring virtual host.</p>

<h2>Configuring Virtual Host</h2>

<p>The steps of configuring apache virtual host are :</p>

<ol>
<li><p>Enabling virtual host configuration in apache config by editing
<code>/etc/apache2/httpd.conf</code>.</p>

<pre><code class="` bash"> $ sudo nano /etc/apache2/httpd.conf
</code></pre></li>
<li><p>Uncomment the section
 <code>Include /private/etc/apache2/extra/httpd-vhosts.conf</code>, then save it.</p></li>
<li><p>Create site directory.
 As an example in this post, let&rsquo;s create a <code>Site</code> folder in home directory called </code>/Users/USERNAME/Sites</code>. Our website sample directory will be put in it, let&rsquo;s create a directory called </code>/Users/USERNAME/Sites/neutro.io</code> and create an <code>/Users/USERNAME/Sites/neutro.io/index.php</code> with simple PHP syntax.</p>

<pre><code class="php"> &lt;?php
 phpinfo();
 ?&gt;
</code></pre></li>
<li><p>Create virtual host configuration by editing the virtual host config</p>

<pre><code class="bash"> $ sudo nano /etc/apache2/extra/httpd-vhosts.conf
</code></pre>

<p> The following code is an example of virtual host with domain name <code>neutro.io</code></p>

<pre><code class="` xml"> &lt;VirtualHost *:80&gt;
     ServerName neutro.io
     ServerAlias www.neutro.io
     DocumentRoot "/Users/neutro/Sites/neutro.io"

 &lt;Directory /Users/neutro/Sites/neutro.io&gt;
         Options Indexes FollowSymLinks
         #Options All Indexes FollowSymLinks
         AllowOverride None
         Require all granted
 &lt;/Directory&gt;


     ErrorLog "/private/var/log/apache2/neutro.io-error_log"
     CustomLog "/private/var/log/apache2/neutro.io-access_log" common
     ServerAdmin web@neutro.io
 &lt;/VirtualHost&gt;
</code></pre>

<p> In this example, we create a <code>neutro.io</code> virtual host that refers to <code>/Users/neutro/Sites/neutro.io</code> as physical directory.</p></li>
<li><p>Register domain for localhost</p>

<p>Since we use <code>neutro.io</code> as domain for localhost, we need to add the domain and <code>www</code> alias to resolve to the localhost address by editing</p>

<pre><code class="bash">    $ sudo nano /etc/hosts
</code></pre>

<p>and add the following line</p>

<pre><code>    127.0.0.1   neutro.io   www.neutro.io
</code></pre></li>
<li><p>Restart apache</p>

<pre><code class="` bash"> $ sudo apachectl restart
</code></pre></li>
</ol>


<p>When we open in browser <code><a href="http://neutro.io">http://neutro.io</a></code>, we should get a page that display PHP info.</p>

<h2>Losing Default Localhost</h2>

<p>After configuring the virtual host, we may lose the previous default localhost that points to <code>/Library/WebServer/Documents/</code> directory. We may get a 403 Forbidden Error when visiting <code><a href="http://localhost">http://localhost</a></code>. To get around this, we need to add in a vhost for localhost and declare this vhost before any of the others. The following code is our new Virtual host after adding config for localhost.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;VirtualHost</span> <span class="err">*:80</span><span class="nt">&gt;</span>
</span><span class='line'>    ServerName localhost
</span><span class='line'>    DocumentRoot /Library/WebServer/Documents/
</span><span class='line'><span class="nt">&lt;/VirtualHost&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;VirtualHost</span> <span class="err">*:80</span><span class="nt">&gt;</span>
</span><span class='line'>    ServerName neutro.io
</span><span class='line'>    ServerAlias www.neutro.io
</span><span class='line'>    DocumentRoot &quot;/Users/neutro/Sites/neutro.io&quot;
</span><span class='line'>
</span><span class='line'>   <span class="nt">&lt;Directory</span> <span class="err">/Users/neutro/Sites/neutro.io</span><span class="nt">&gt;</span>
</span><span class='line'>        Options Indexes FollowSymLinks
</span><span class='line'>        #Options All Indexes FollowSymLinks
</span><span class='line'>        AllowOverride None
</span><span class='line'>        Require all granted
</span><span class='line'>   <span class="nt">&lt;/Directory&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    ErrorLog &quot;/private/var/log/apache2/neutro.io-error_log&quot;
</span><span class='line'>    CustomLog &quot;/private/var/log/apache2/neutro.io-access_log&quot; common
</span><span class='line'>    ServerAdmin web@neutro.io
</span><span class='line'><span class="nt">&lt;/VirtualHost&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Restart apache and open <code><a href="http://localhost">http://localhost</a></code> in browser.</p>

<h2>References</h2>

<ol>
<li><a href="https://websitebeaver.com/set-up-localhost-on-macos-high-sierra-apache-mysql-and-php-7-with-sslhttps">https://websitebeaver.com/set-up-localhost-on-macos-high-sierra-apache-mysql-and-php-7-with-sslhttps</a></li>
<li><a href="https://coolestguidesontheplanet.com/set-up-virtual-hosts-in-apache-on-macos-high-sierra-10-13/">https://coolestguidesontheplanet.com/set-up-virtual-hosts-in-apache-on-macos-high-sierra-10-13/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PPTP on macOS]]></title>
    <link href="http://neutrofoton.github.io/blog/2017/11/22/pptp-on-macos/"/>
    <updated>2017-11-22T06:59:38+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2017/11/22/pptp-on-macos</id>
    <content type="html"><![CDATA[<p>One day I need to connect my macOS to a network of client of the company I work for via <a href="https://en.wikipedia.org/wiki/Point-to-Point_Tunneling_Protocol">Point-to-Point Tunneling Protocol (PPTP)</a> VPN. Unfortunately <a href="https://support.apple.com/en-us/HT206844">Apple removed PPTP support on macOS Sierra</a>, so I had to find an alternative for that. Some of them I found are third parties application that need a one time buying or annual subscription. In fact, Apple just remove the user interface option for PPTP VPN, meanwhile the libraries of it are still available on Sierre.</p>

<p>Since the libraries of PPTP are still available on Sierra, theoritically we should be able to call the libraries via terminal. Finally I found 3 blogs that write about PPTP protocol on macos and I put them in a reference section in this blog. Basically the three of them use the same technique that&rsquo;s write a script contains configuration of PPTP that&rsquo;s put in <code>/etc/ppp/peers/</code> and call it via <code>pppd</code> command via terminal.</p>

<p>First of all create a file called <code>/etc/ppp/peers/pptpvpn-client1</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo /etc/ppp/peers/pptpvpn-client1
</span></code></pre></td></tr></table></div></figure>


<p>Fill the <code>pptpvpn-client1</code> that contains configuration that pppd daemon will refer to connect.</p>

<figure class='code'><figcaption><span>/etc/ppp/peers/pptpvpn-client1</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>plugin PPTP.ppp
</span><span class='line'>noauth
</span><span class='line'><span class="c"># logfile /tmp/ppp.log</span>
</span><span class='line'>remoteaddress <span class="s2">&quot;xxx.xxx.xxx.xxx&quot;</span>
</span><span class='line'>user <span class="s2">&quot;xxxxxx&quot;</span>
</span><span class='line'>password <span class="s2">&quot;xxxxxxxx&quot;</span>
</span><span class='line'>redialcount 1
</span><span class='line'>redialtimer 5
</span><span class='line'>idle 1800
</span><span class='line'><span class="c"># mru 1368</span>
</span><span class='line'><span class="c"># mtu 1368</span>
</span><span class='line'>receive-all
</span><span class='line'>novj 0:0
</span><span class='line'>ipcp-accept-local
</span><span class='line'>ipcp-accept-remote
</span><span class='line'><span class="c"># noauth</span>
</span><span class='line'>refuse-eap
</span><span class='line'>refuse-pap
</span><span class='line'>refuse-chap-md5
</span><span class='line'>hide-password
</span><span class='line'>mppe-stateless
</span><span class='line'>mppe-128
</span><span class='line'><span class="c"># require-mppe-128</span>
</span><span class='line'>looplocal
</span><span class='line'>nodetach
</span><span class='line'><span class="c"># ms-dns 8.8.8.8</span>
</span><span class='line'>usepeerdns
</span><span class='line'><span class="c"># ipparam gwvpn</span>
</span><span class='line'>defaultroute
</span><span class='line'>debug
</span></code></pre></td></tr></table></div></figure>


<p>Then open terminal and call</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo pppd call pptpvpn-client1
</span></code></pre></td></tr></table></div></figure>


<p>If you cannot connect with the configuration code I use, you can check the error messages displayed in terminal. May be some configuration items do not match with the vpn server setting you connect to.</p>

<p>If the you got no any error messages and connection established with your VPN network you can open a new tab on the terminal and try to ping to an ip address in the VPN local network.</p>

<h2>References</h2>

<ol>
<li><a href="https://smallhacks.wordpress.com/2016/12/20/pptp-on-osx-sierra/">https://smallhacks.wordpress.com/2016/12/20/pptp-on-osx-sierra/</a></li>
<li><a href="https://malucelli.net/2017/05/16/pptp-vpn-on-macos-sierra/">https://malucelli.net/2017/05/16/pptp-vpn-on-macos-sierra/</a></li>
<li><a href="https://www.cts-llc.net/2017/02/21/pptp-on-osx-just-one-last-time.html">https://www.cts-llc.net/2017/02/21/pptp-on-osx-just-one-last-time.html</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Create and Consume C++ Class DLL on Windows]]></title>
    <link href="http://neutrofoton.github.io/blog/2017/09/14/create-and-consume-c-plus-plus-class-dll-on-windows/"/>
    <updated>2017-09-14T13:04:05+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2017/09/14/create-and-consume-c-plus-plus-class-dll-on-windows</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/cpp.png"></p>

<p>while visiting clients of the company I work on, sometime I still found some applications especially desktop application build on unmanaged code (such as Delphi, Visual Basic 6, C++, etc). Even though at the time of this blog post, many application build on .NET (managed code) on Windows platform. There are various reasons why they do not migrate to managed code which has some advantages over unmanaged code (such as the application still run well with the version of OS they use, rewrite app will need extra cost, etc). This means unmanaged code application is not dead at all for LOB app, even though the percentage is much lower than the managed one.</p>

<p>Maybe this topic seems out of date topic in the .NET era, but at least this post as a note for my self in case I need it on the other day.</p>

<p>While developing an application, usually we want to share some of our code with other application. Dynamic Link Library (DLL) is Microsoft&rsquo;s implementation of the shared library concept in the Microsoft Windows. The term DLL in this post will refer to unmanaged code and only focus to the one build with Visual C++ compiler on Windows environment.</p>

<p>When we create a DLL, we also create a .lib file that contains information of exported class or functions. When we build an executable that calls the DLL, the linker uses the exported symbols in the .lib file to store this information for the loader. When the loader loads a DLL, the DLL is mapped into the memory space of the executable.</p>

<p>An executable file links to (or loads) a DLL in one of two ways, <em>implicit</em> or <em>explicit linking</em>. In this post will create simple sample both of them how C++ class exported in the two ways. The samples in this post created using IDE Microsoft Visual Studio 2013 Ultimate. To simplify the code, I just created a single solution contains a Win32 DLL project and a console application client. The DLL project contains classes for both sample <em>implicit</em> and <em>explicit linking</em>. Either the console application contains sample code for <em>implicit</em> and <em>explicit linking</em> caller. Here is the classes I use in this sample.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-09-04-classdiagram.png"></p>

<h2>Implicit Linking</h2>

<p><em>Implicit linking</em>, where the operating system loads the DLL when the executable using it is loaded. The executable client calls the exported functions of the DLL just as if the functions were statically linked and contained within the executable. <em>Implicit linking</em> is sometimes referred to as static load or load-time dynamic linking<sup>[4]</sup>. Now let&rsquo;s create a sample of DLL with <em>implicit linking</em>.</p>

<p>First of all, create an empty solution in Visual Studio by selecting <code>File</code> > <code>New Project</code> > scroll down on the left pane, expand <code>Other Project Types</code> > <code>Visual Studio Solutions</code> select <code>Black Solution</code>. Fill the solution name as <code>VCppDLL</code>.</p>

<p>Now we have an empty solution in Visual Studio. Right click the <code>VCppDLL</code> solution > <code>Add</code> > <code>New Project</code>. In the left pane of the New Project dialog box, expand Installed templates <code>Visual C++</code>, and then select <code>Win32</code>. Fill the project name as <strong>MathWin32DLL</strong>, then click OK.</p>

<p>On the Win32 Application Wizard dialog in the <code>Application Settings</code> part, select <code>DLL</code> and check <code>Empty project</code>, then click Finish</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-09-04-Win32AppWizard.png"></p>

<p>Now we have an empty C++ DLL project in the Visual Studio solution. As the class diagram picture above, let create a simple <code>BaseMath</code> class. Right click the MathWin32DLL project > <code>Add</code> > <code>Class</code>. On <code>Visual C++</code> template on the left pane dialog, select <code>C++ Class</code> > click <code>Add</code>. On the <code>Generic C++ Class Wizard</code>, fill the <code>Class name</code> as <strong>BaseMath</strong> then click <code>Finish</code>. Edit the <code>BaseMath.h</code> with the following code.</p>

<figure class='code'><figcaption><span>BaseMath.h</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="c1">// If you are building the DLL project on the command line,</span>
</span><span class='line'><span class="c1">// use the /D compiler option to define the MATHDLLWIN32_EXPORTS symbol.</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#pragma once</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef MATHWIN32DLL_EXPORTS</span>
</span><span class='line'><span class="cp">#define Math_API __declspec(dllexport)</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'><span class="cp">#define Math_API __declspec(dllimport)</span>
</span><span class='line'><span class="cp">#endif </span><span class="c1">// MATHWIN32DLL_EXPORTS</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="n">core</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">BaseMath</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="k">public</span><span class="o">:</span>
</span><span class='line'>      <span class="k">virtual</span> <span class="kt">void</span> <span class="n">Destroy</span><span class="p">()</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">delete</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">virtual</span> <span class="n">string</span> <span class="n">Say</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">virtual</span> <span class="kt">double</span> <span class="n">Calculate</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can delete <code>BaseMath.cpp</code> file since we will make the <code>BaseMath</code> as an <em>abstract class</em>.</p>

<p>In Visual Studio, by default the New Project template for a DLL adds PROJECTNAME_EXPORTS to the defined preprocessor symbols for the DLL project. We can see the preprocessor symbols definition in <code>Property Pages</code> of <strong>MathWin32DLL</strong> project in the <code>Configuration Properties</code> > <code>C/C++</code> > <code>Preposesor</code> > <code>Preposesor Definitions</code>.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-09-04-preposesordefinitions.png"></p>

<p>In the code of <code>BaseMath.h</code>, when <code>MATHWIN32DLL_EXPORTS</code> symbol is defined, the <code>Math_API</code> symbol is set to <code>__declspec(dllexport)</code> modifier otherwise it is set to <code>__declspec(dllimport)</code>. The <code>__declspec(dllexport)</code> modifier can be applied to classes, functions, or variables that tells the compiler and linker to export them from the DLL so that it can be used by other applications.</p>

<p>Meanwhile when we include <code>BaseMath.h</code> in client project, <code>Math_API</code> is set to <code>__declspec(dllimport)</code>. This modifier optimizes the import of the exported class in an application.</p>

<p>For the next, let&rsquo;s create another class called <code>AddOperationMath</code>. Edit the <code>AddOperationMath.h</code> and <code>AddOperationMath.cpp</code> respectively as follow.</p>

<figure class='code'><figcaption><span>AddOperationMath.h</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#pragma once</span>
</span><span class='line'><span class="cp">#include &quot;BaseMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="n">core</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">// MS Visual C++ compiler emits C4275 warning about not exported base class.</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">Math_API</span> <span class="nl">AddOperationMath</span> <span class="p">:</span> <span class="k">public</span> <span class="n">BaseMath</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="k">public</span><span class="o">:</span>
</span><span class='line'>      <span class="n">AddOperationMath</span><span class="p">();</span>
</span><span class='line'>      <span class="k">virtual</span> <span class="o">~</span><span class="n">AddOperationMath</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="n">string</span> <span class="nf">Say</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>      <span class="kt">double</span> <span class="nf">Calculate</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">static</span> <span class="kt">double</span> <span class="nf">Add</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>AddOperationMath.cpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &quot;AddOperationMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="n">core</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">AddOperationMath</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">AddOperationMath</span><span class="o">::~</span><span class="n">AddOperationMath</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">string</span> <span class="n">AddOperationMath</span><span class="o">::</span><span class="n">Say</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">string</span> <span class="n">result</span> <span class="o">=</span>  <span class="n">s</span> <span class="o">+</span> <span class="s">&quot; is calling add operation of class AddOperationMath&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">double</span> <span class="n">AddOperationMath</span><span class="o">::</span><span class="n">Calculate</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">double</span> <span class="n">AddOperationMath</span><span class="o">::</span><span class="n">Add</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The class <code>AddOperationMath</code> inherits from <code>BaseMath</code>. We also mark the <code>AddOperationMath</code> class with <code>Math_API</code> macro that&rsquo;s defined in <code>BaseMath.h</code> which means we will expose the <code>AddOperationMath</code> class in the DLL to executable client application. When we compile the DLL project, we should get a warning</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>warning C4275: non dll-interface class &#39;core::BaseMath&#39; used as base for dll-interface class &#39;core::AddOperationMath&#39;
</span></code></pre></td></tr></table></div></figure>


<p>In this case, ideally we should export (mark with <code>Math_API</code> macro) both <code>core::BaseMath</code> and <code>core::AddOperationMath</code> to make the compiler does not fire the warning message.</p>

<p>To complete our sample, let&rsquo;s create another project called <strong><em>MathWin32ClientConsole</em></strong> as we did the creation of <strong><em>MathWin32DLL</em></strong> project, except select <code>Console Application</code> instead of <code>DLL</code> in the <code>Application Settings</code> dialog.</p>

<p>In the <strong><em>MathWin32ClientConsole</em></strong> project, right click > <code>Add</code> > <code>New Item</code>. Select <code>Visual C++</code> project template on the left pane, then select <code>C++ File (.cpp)</code>. Fill the name with <code>Main.cpp</code>.</p>

<p>To make the <strong><em>MathWin32ClientConsole</em></strong> project has reference to <strong><em>MathWin32DLL</em></strong> project, right click <strong><em>MathWin32ClientConsole</em></strong> project > <code>Properties</code>. Scroll up the <code>Property Pages</code> dialog, expand <code>Common Properties</code> on the left pane > select <code>References</code>. Click <code>Add New Reference</code> button, select <code>Projects</code> and check the <code>MathWin32DLL</code> > <code>OK</code>. Now you should see <code>MathWin32DLL</code> added to the <code>References</code> pane as the following picture.</p>

<p> <img class="center" src="http://neutrofoton.github.io/images/post/2017-09-04-MathWin32ClientConsoleReference.png"></p>

<p> To make the <code>AddOperationMath</code> class is recognized in the <strong><em>MathWin32ClientConsole</em></strong> project, we have to include <code>AddOperationMath.h</code>. We can copy the <code>AddOperationMath.h</code> and <code>BaseMath.h</code> to the <strong><em>MathWin32ClientConsole</em></strong> project. But it is not a good way in our scenario, because if we make changes to one of them, we have to recopy it to the <strong><em>MathWin32ClientConsole</em></strong> project directory. To avoid this manual copy, we can include the <strong><em>MathWin32DLL</em></strong> project directory to the <strong><em>MathWin32ClientConsole</em></strong> so that we can include any header files of <strong><em>MathWin32DLL</em></strong> to <strong><em>MathWin32ClientConsole</em></strong> if needed. To do that open the Property pages of <strong><em>MathWin32ClientConsole</em></strong>, select <code>Configuration Properties</code> > <code>C/C++</code> > <code>General</code>. Select the drop-down control next to the <code>Additional Include Directories</code> edit box, and then choose <code>&lt;Edit...&gt;</code>. Select the top pane of the <code>Additional Include Directories</code> dialog box to enable an edit control. In the edit control, fill <code>$(SolutionDir)\MathWin32DLL</code> which tells to Visual Studio to scan or search header files that we include in directory <code>MathWin32DLL</code> inside solution directory.</p>

<p> <img class="center" src="http://neutrofoton.github.io/images/post/2017-09-04-IncludeMathWin32DLLDirectory.png"></p>

<p>Now we can include header file defined in <code>MathWin32DLL</code> from <code>MathWin32ClientConsole</code>. Let create code that call class defined in the DLL.</p>

<figure class='code'><figcaption><span>Main.cpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;iostream&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &quot;AddOperationMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">CallDLLByImplicitLinking</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">string</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>  <span class="n">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;neutro&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">CallDLLByImplicitLinking</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Press any key to exit &quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="n">cin</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">CallDLLByImplicitLinking</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">string</span> <span class="n">s</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; + &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">core</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="o">::</span><span class="n">Add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">core</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="o">*</span> <span class="n">math</span> <span class="o">=</span> <span class="k">new</span> <span class="n">core</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="p">();</span>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">math</span><span class="o">-&gt;</span><span class="n">Say</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">delete</span> <span class="n">math</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;===============================================================&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>2 + 4 = 6
</span><span class='line'>neutro is calling add operation of class AddOperationMath
</span><span class='line'>
</span><span class='line'>Press any key to exit
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>There is no need to explicitly specify a calling convention for exporting classes or their methods. By default, the C++ compiler uses the <code>__thiscall</code> calling convention for class methods. However, due to different naming decoration schemes that are used by different compilers, the exported C++ class can only be used by the same compiler and by the same version of the compiler. Only the MS Visual C++ compiler can use this DLL now. Both the DLL and the client code must be compiled with the same version of MS Visual C++ in order to ensure that the naming decoration scheme matches between the caller and the callee<sup>[5]</sup></p></blockquote>

<p>To use a DLL by <em>implicit linking</em>, an executable must include the header files that declare the data, functions or C++ classes exported by the DLL in each source file that contains calls to the exported data, functions, and classes.  The classes, functions, and data exported by the DLL must all be marked <code>__declspec(dllimport)</code> in the header file. From a coding perspective, calls to the exported functions are just like any other function call.</p>

<p>To build the calling executable file, we must link with the import library (.lib). If we use an external makefile or build system, we need to specify the file name of the import library where we list other object (.obj) files or libraries that we link.</p>

<p>The operating system must be able to locate the DLL file when it loads the calling executable. This means that we must deploy or verify the existence of the DLL when our application is installed.</p>

<h2>Explicit Linking</h2>

<p><em>Explicit linking</em>, where the operating system loads the DLL on demand at runtime. An executable that uses a DLL by <em>explicit linking</em> must make function calls to explicitly load and unload the DLL and to access the functions exported by the DLL. Unlike calls to functions in a statically linked library, the client executable must call the exported functions in a DLL through a function pointer. <em>Explicit linking</em> is sometimes referred to as dynamic load or run-time dynamic linking<sup>[4]</sup>.</p>

<p>To use a DLL by <em>explicit linking</em>, applications must make a function call to explicitly load the DLL at run time. To explicitly link to a DLL, an application must <sup>[4]</sup>:</p>

<ol>
<li><p>Call <code>LoadLibrary</code>, <code>LoadLibraryEx</code>, or a similar function to load the DLL and obtain a module handle.</p></li>
<li><p>Call <code>GetProcAddress</code> to obtain a function pointer to each exported function that the application calls. Because applications call the DLL functions through a pointer, the compiler does not generate external references, so there is no need to link with an import library. However, you must have a typedef or using statement that defines the call signature of the exported functions that you call.</p></li>
<li><p>Call <code>FreeLibrary</code> when done with the DLL.</p></li>
</ol>


<p>To create a sample for <em>explicit linking</em>, we will use an abstract interface (a class with pure virtual methods, and no data) and create a factory method for object instantiation.</p>

<p>On the <strong><em>MathWin32DLL</em></strong> create a new class called <code>LogarithmicMath</code>. Edit the header and implementation files as follow</p>

<figure class='code'><figcaption><span>LogarithmicMath.h</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#pragma once</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &quot;BaseMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="n">core</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">LogarithmicMath</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BaseMath</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="k">public</span><span class="o">:</span>
</span><span class='line'>      <span class="n">LogarithmicMath</span><span class="p">();</span>
</span><span class='line'>      <span class="k">virtual</span> <span class="o">~</span><span class="n">LogarithmicMath</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="n">string</span> <span class="nf">Say</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>      <span class="kt">double</span> <span class="nf">Calculate</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>LogarithmicMath.cpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &quot;LogarithmicMath.h&quot;</span>
</span><span class='line'><span class="cp">#include &lt;math.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="n">core</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">LogarithmicMath</span><span class="o">::</span><span class="n">LogarithmicMath</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="n">LogarithmicMath</span><span class="o">::~</span><span class="n">LogarithmicMath</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">string</span> <span class="n">LogarithmicMath</span><span class="o">::</span><span class="n">Say</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">string</span> <span class="n">result</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot; is calling Logarithmic operation of class LogarithmicMath&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">double</span> <span class="n">LogarithmicMath</span><span class="o">::</span><span class="n">Calculate</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">log10</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">log10</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, create a <code>Factory</code> class that encapsulates <code>LogarithmicMath</code> instantiation and will be called from client app.</p>

<figure class='code'><figcaption><span>Factory.h</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &quot;BaseMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="n">Math_API</span> <span class="n">core</span><span class="o">::</span><span class="n">BaseMath</span><span class="o">*</span> <span class="kr">__cdecl</span> <span class="n">CreateLogarithmicMath</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Factory.cpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &quot;Factory.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;LogarithmicMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">core</span><span class="o">::</span><span class="n">BaseMath</span><span class="o">*</span> <span class="n">CreateLogarithmicMath</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">new</span> <span class="n">core</span><span class="o">::</span><span class="n">LogarithmicMath</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can see that the <code>LogarithmicMath</code> class look like a standard C++ class. Instead of directly export the <code>LogarithmicMath</code> class, we use <code>Factory</code> that handle the export technics.</p>

<p>In the <code>Factory.h</code> defined <code>extern "C"</code> which tells the C++ compiler that the linker should use the C calling convention. It is required in order to prevent the mangling of the function name. So, this function is exposed as a regular C function, and can be easily recognized by any C-compatible compiler. The name itself is exported from the DLL unmangled (<code>CreateLogarithmicMath</code>). The <code>Math_API</code> tells the linker to export the <code>CreateLogarithmicMath</code> method from the DLL. <code>__cdecl</code> is the default calling convention for C and C++ programs.</p>

<p>Now let create a sample code in the <strong><em>MathWin32ClientConsole</em></strong> by editing the <code>Main.cpp</code> as following.</p>

<figure class='code'><figcaption><span>Main.cpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;iostream&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &lt;Windows.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &quot;AddOperationMath.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">typedef</span> <span class="n">core</span><span class="o">::</span><span class="n">BaseMath</span><span class="o">*</span> <span class="p">(</span><span class="kr">__cdecl</span> <span class="o">*</span><span class="n">LogarithmicMathFactory</span><span class="p">)();</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">CallDLLByImplicitLinking</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">string</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'><span class="kt">void</span> <span class="nf">CallDLLByExplicitLinking</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">string</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>  <span class="n">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;neutro&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">CallDLLByImplicitLinking</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>  <span class="n">CallDLLByExplicitLinking</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Press any key to exit &quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="n">cin</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">CallDLLByImplicitLinking</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">string</span> <span class="n">s</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; + &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">core</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="o">::</span><span class="n">Add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">core</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="o">*</span> <span class="n">math</span> <span class="o">=</span> <span class="k">new</span> <span class="n">core</span><span class="o">::</span><span class="n">AddOperationMath</span><span class="p">();</span>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">math</span><span class="o">-&gt;</span><span class="n">Say</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">delete</span> <span class="n">math</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;===============================================================&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">CallDLLByExplicitLinking</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">string</span> <span class="n">s</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">HMODULE</span> <span class="n">dll</span> <span class="o">=</span> <span class="n">LoadLibrary</span><span class="p">(</span><span class="s">L&quot;MathWin32DLL.dll&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dll</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Fail load library&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">LogarithmicMathFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">LogarithmicMathFactory</span><span class="o">&gt;</span><span class="p">(</span><span class="n">GetProcAddress</span><span class="p">(</span><span class="n">dll</span><span class="p">,</span> <span class="s">&quot;CreateLogarithmicMath&quot;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">factory</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Unable to load CreateLogarithmicMath from DLL!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="n">FreeLibrary</span><span class="p">(</span><span class="n">dll</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">core</span><span class="o">::</span><span class="n">BaseMath</span><span class="o">*</span> <span class="n">instance</span> <span class="o">=</span> <span class="n">factory</span><span class="p">();</span>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; log (&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;) = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">instance</span><span class="o">-&gt;</span><span class="n">Calculate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">instance</span><span class="o">-&gt;</span><span class="n">Say</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">instance</span><span class="o">-&gt;</span><span class="n">Destroy</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">FreeLibrary</span><span class="p">(</span><span class="n">dll</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;===============================================================&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now build and run the <strong><em>MathWin32ClientConsole</em></strong>, we should get the following output.</p>

<figure class='code'><figcaption><span>output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>2 + 4 = 6
</span><span class='line'>neutro is calling add operation of class AddOperationMath
</span><span class='line'>
</span><span class='line'>===============================================================
</span><span class='line'>2 log (4) = 2
</span><span class='line'>neutro is calling Logarithmic operation of class LogarithmicMath
</span><span class='line'>
</span><span class='line'>===============================================================
</span><span class='line'>Press any key to exit
</span></code></pre></td></tr></table></div></figure>


<p>In order to ensure proper resource release, an abstract interface provides an additional method for the disposal of an instance. In this case we provide <code>Destroy</code> method. Calling this method manually can be tedious and error prone. It&rsquo;s recommend use smart pointer for auto resource release instead of manual release.</p>

<p>The code of this article can be found <a href="https://github.com/neutrofoton/VCppDLL">here</a></p>

<h2>References</h2>

<ol>
<li><a href="https://docs.microsoft.com/en-us/cpp/build/walkthrough-creating-and-using-a-dynamic-link-library-cpp">https://docs.microsoft.com/en-us/cpp/build/walkthrough-creating-and-using-a-dynamic-link-library-cpp</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/1ez7dh12.aspx">https://msdn.microsoft.com/en-us/library/1ez7dh12.aspx</a></li>
<li><a href="https://docs.microsoft.com/en-us/cpp/build/dlls-in-visual-cpp">https://docs.microsoft.com/en-us/cpp/build/dlls-in-visual-cpp</a></li>
<li><a href="https://docs.microsoft.com/en-us/cpp/build/linking-an-executable-to-a-dll#determining-which-linking-method-to-use">https://docs.microsoft.com/en-us/cpp/build/linking-an-executable-to-a-dll#determining-which-linking-method-to-use</a></li>
<li><a href="https://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL">https://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL</a></li>
<li><a href="http://eli.thegreenplace.net/2011/09/16/exporting-c-classes-from-a-dll">http://eli.thegreenplace.net/2011/09/16/exporting-c-classes-from-a-dll</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[WinMerge and DiffMerge as Git Diff Merge Tool]]></title>
    <link href="http://neutrofoton.github.io/blog/2017/05/10/winmerge-and-diffmerge-as-git-diff-merge-tool/"/>
    <updated>2017-05-10T10:01:23+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2017/05/10/winmerge-and-diffmerge-as-git-diff-merge-tool</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/git.png">
On software development while working with source control, it&rsquo;s inevitable sometime we get our code conflicts with other, since we work in a team. There are many diff and merge tools out there and some of them can be integrated with with Git. In this post I just want to note what I did in my development machine (Windows 7 and macOS Sierra)</p>

<h2>DiffMerge on macOS</h2>

<p>For my macOS development machine I use <a href="http://www.sourcegear.com/diffmerge/">DiffMerge</a>. Actually DiffMerge is not only available for macOS, but also for Windows and Linux. So we can use it as Git diff merge tool as well on Windows and Linux. To configure Git to use DiffMerge can be done by running the following command via terminal.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git config --global mergetool.prompt <span class="nb">false</span>
</span><span class='line'><span class="nv">$ </span>git config --global mergetool.keepBackup <span class="nb">false</span>
</span><span class='line'><span class="nv">$ </span>git config --global mergetool.keepTemporaries <span class="nb">false</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>git config --global diff.tool diffmerge
</span><span class='line'><span class="nv">$ </span>git config --global difftool.diffmerge.cmd <span class="s1">&#39;diffmerge &quot;$LOCAL&quot; &quot;$REMOTE&quot;&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>git config --global merge.tool diffmerge
</span><span class='line'><span class="nv">$ </span>git config --global mergetool.diffmerge.cmd <span class="s1">&#39;diffmerge --merge --result=&quot;$MERGED&quot; &quot;$LOCAL&quot; &quot;$(if test -f &quot;$BASE&quot;; then echo &quot;$BASE&quot;; else echo &quot;$LOCAL&quot;; fi)&quot; &quot;$REMOTE&quot;&#39;</span>
</span><span class='line'><span class="nv">$ </span>git config --global mergetool.diffmerge.trustExitCode <span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>The command will add the following config code in global <code>.gitconfig</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>mergetool<span class="o">]</span>
</span><span class='line'>  <span class="nv">prompt</span> <span class="o">=</span> <span class="nb">false</span>
</span><span class='line'><span class="nb">  </span><span class="nv">keepBackup</span> <span class="o">=</span> <span class="nb">false</span>
</span><span class='line'><span class="nb">  </span><span class="nv">keepTemporaries</span> <span class="o">=</span> <span class="nb">false</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span>diff<span class="o">]</span>
</span><span class='line'>  <span class="nv">tool</span> <span class="o">=</span> diffmerge
</span><span class='line'>
</span><span class='line'><span class="o">[</span>difftool <span class="s2">&quot;diffmerge&quot;</span><span class="o">]</span>
</span><span class='line'>  <span class="nv">cmd</span> <span class="o">=</span> diffmerge <span class="se">\&quot;</span><span class="nv">$LOCAL</span><span class="se">\&quot;</span> <span class="se">\&quot;</span><span class="nv">$REMOTE</span><span class="se">\&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span>merge<span class="o">]</span>
</span><span class='line'>  <span class="nv">tool</span> <span class="o">=</span> diffmerge
</span><span class='line'>
</span><span class='line'><span class="o">[</span>mergetool <span class="s2">&quot;diffmerge&quot;</span><span class="o">]</span>
</span><span class='line'>  <span class="nv">cmd</span> <span class="o">=</span> <span class="s2">&quot;diffmerge --merge --result=\&quot;$MERGED\&quot; \&quot;$LOCAL\&quot; \&quot;$(if test -f \&quot;$BASE\&quot;; then echo \&quot;$BASE\&quot;; else echo \&quot;$LOCAL\&quot;; fi)\&quot; \&quot;$REMOTE\&quot;&quot;</span>
</span><span class='line'>  <span class="nv">trustExitCode</span> <span class="o">=</span> <span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can also directly edit the <code>.gitconfig</code> and manually add the config code.</p>

<h2>WinMerge 2.x on Windows</h2>

<p><a href="http://winmerge.org/">WinMerge</a> is an open source differencing and merging tool for Windows. It can compare both folders and files, presenting differences in a visual text format that is easy to understand and handle.
At the time of writing this blog post, WinMerge 3 is still in progress of development and no release yet. WinMerge 3 will be modern compare/synchronization tool. It will be based on Qt library and cross-platform. You can use the same tool in Windows and in Linux.
So for now and so on in this blog post, WinMerge term means WinMerge 2.x.</p>

<p>After installing WinMerge, to configure it as diff and merge tool of Git is by adding /editing the following config setting to <code>C:\Users\{UserName}\.gitconfig</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>mergetool<span class="o">]</span>
</span><span class='line'>  <span class="nv">prompt</span> <span class="o">=</span> <span class="nb">false</span>
</span><span class='line'><span class="nb">  </span><span class="nv">keepBackup</span> <span class="o">=</span> <span class="nb">false</span>
</span><span class='line'><span class="nb">  </span><span class="nv">keepTemporaries</span> <span class="o">=</span> <span class="nb">false</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span>merge<span class="o">]</span>
</span><span class='line'>  <span class="nv">tool</span> <span class="o">=</span> winmerge
</span><span class='line'>
</span><span class='line'><span class="o">[</span>mergetool <span class="s2">&quot;winmerge&quot;</span><span class="o">]</span>
</span><span class='line'>  <span class="nv">name</span> <span class="o">=</span> WinMerge
</span><span class='line'>  <span class="nv">trustExitCode</span> <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'><span class="nb">  </span><span class="nv">cmd</span> <span class="o">=</span> <span class="s2">&quot;/c/Program\\ Files\\ \\(x86\\)/WinMerge/WinMergeU.exe&quot;</span> -u -e -dl <span class="se">\&quot;</span>Local<span class="se">\&quot;</span> -dr <span class="se">\&quot;</span>Remote<span class="se">\&quot;</span> <span class="nv">$LOCAL</span> <span class="nv">$REMOTE</span> <span class="nv">$MERGED</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span>diff<span class="o">]</span>
</span><span class='line'>  <span class="nv">tool</span> <span class="o">=</span> winmerge
</span><span class='line'>
</span><span class='line'><span class="o">[</span>difftool <span class="s2">&quot;winmerge&quot;</span><span class="o">]</span>
</span><span class='line'>  <span class="nv">name</span> <span class="o">=</span> WinMerge
</span><span class='line'>  <span class="nv">trustExitCode</span> <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'><span class="nb">  </span><span class="nv">cmd</span> <span class="o">=</span> <span class="s2">&quot;/c/Program\\ Files\\ \\(x86\\)/WinMerge/WinMergeU.exe&quot;</span> -u -e <span class="nv">$LOCAL</span> <span class="nv">$REMOTE</span>
</span></code></pre></td></tr></table></div></figure>


<p>The config above also can be configured by Git bash shell with <code>&ndash;global</code> parameter instead of manual edit via text editor.</p>

<p>Now, whenever you want it to launch diffs just use difftool[1]:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># diff the local file.m against the checked-in version</span>
</span><span class='line'><span class="nv">$ </span>git difftool file.m
</span><span class='line'>
</span><span class='line'><span class="c"># diff the local file.m against the version in some-feature-branch</span>
</span><span class='line'><span class="nv">$ </span>git difftool some-feature-branch file.m
</span><span class='line'>
</span><span class='line'><span class="c"># diff the file.m from the Build-54 tag to the Build-55 tag</span>
</span><span class='line'><span class="nv">$ </span>git difftool Build-54..Build-55 file.m
</span></code></pre></td></tr></table></div></figure>


<p>To resolve merge conflicts</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git mergetool
</span></code></pre></td></tr></table></div></figure>


<h2>References</h2>

<ol>
<li><a href="http://twobitlabs.com/2011/08/install-diffmerge-git-mac-os-x/">http://twobitlabs.com/2011/08/install-diffmerge-git-mac-os-x/</a></li>
<li><a href="http://winmerge.org/">http://winmerge.org/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Arduino and NEO-6M GPS Module]]></title>
    <link href="http://neutrofoton.github.io/blog/2017/05/04/arduino-and-neo-6m-gps-module/"/>
    <updated>2017-05-04T07:32:17+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2017/05/04/arduino-and-neo-6m-gps-module</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/arduino.png">
Couple days ayo, I met a friend of mine when I was at university. He plays extensively with <a href="http://www.arduino.org">Arduino</a>, <a href="https://www.raspberrypi.org">Raspberry Pi</a>, <a href="http://www.orangepi.org">Orange Pi</a> and other IoT stuff. He showed me how interesting IoT is, include wiring modules, and surely its programming. I remember that a few months ago, I got Arduino kit with GPS module from another friend of mine. The items were idle since I have other things to do in my work. Yesterday, I just have a free time to play with the Arduino kit. And I never play or explore Arduino before.</p>

<p>On the first time exploring Arduino, the hardware I use are :</p>

<ol>
<li><a href="http://www.arduino.org/products/boards/arduino-uno">Arduino Uno</a></li>
<li><a href="https://www.aliexpress.com/store/product/GPS-Receiver-U-blox-NEO-6M-Module-with-Ceramic-Antenna-TTL-Interface-for-raspberry-pi-2/1266255_32365271431.html">GPS Module NEO-6M-0-001</a></li>
</ol>


<p>To get working Arduino with GPS module, I use <a href="https://github.com/mikalhart/TinyGPS">TinyGPS</a> library. TinyGPS is designed to provide most of the NMEA GPS functionality. The detail description about TinyGPS can found <a href="http://arduiniana.org/libraries/tinygps/">here</a>. TinyGPS is additional library for Arduino. So we need to install it before include it to our project. The steps of installation additional Arduino libraries can be found <a href="https://www.arduino.cc/en/Guide/Libraries">here</a></p>

<p>The table below shows wiring between Arduino and NEO-6M-0-001 GPS module</p>

<table>
<thead>
<tr>
<th> NEO-6M-0-001 GPS     </th>
<th> Arduino Uno      </th>
<th> Cable</th>
</tr>
</thead>
<tbody>
<tr>
<td> Vcc                  </td>
<td> Power 3.3 Volt   </td>
<td> Black</td>
</tr>
<tr>
<td> GND                  </td>
<td> GND              </td>
<td> White</td>
</tr>
<tr>
<td> TXD                  </td>
<td> RX pin 4         </td>
<td> Gray</td>
</tr>
<tr>
<td> RXD                  </td>
<td> TX pin 3         </td>
<td> Magenta</td>
</tr>
</tbody>
</table>


<p><p/></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-05-04-neo-6m-0-0-001.png"></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-05-04-arduino-uno.png"></p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-05-04-arduino-uno-gps.png"></p>

<p>To simplify our testing, I grab sample source code provided by <a href="https://github.com/mikalhart/TinyGPS">TinyGPS</a>. On This sample, I Set the data rate in bits per second (baud) for serial data transmission to 9600.</p>

<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;SoftwareSerial.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &lt;TinyGPS.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/<em> This sample code demonstrates the normal use of a TinyGPS object.</span>
</span><span class='line'><span class="cm">   It requires the use of SoftwareSerial, and assumes that you have a</span>
</span><span class='line'><span class="cm">   4800-baud serial GPS device hooked up on pins 4(rx) and 3(tx).</span>
</span><span class='line'><span class="cm"></em>/</span>
</span><span class='line'>
</span><span class='line'><span class="n">TinyGPS</span> <span class="n">gps</span><span class="p">;</span>
</span><span class='line'><span class="n">SoftwareSerial</span> <span class="nf">ss</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">smartdelay</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ms</span><span class="p">);</span>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_float</span><span class="p">(</span><span class="kt">float</span> <span class="n">val</span><span class="p">,</span> <span class="kt">float</span> <span class="n">invalid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">int</span> <span class="n">prec</span><span class="p">);</span>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_int</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">invalid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_date</span><span class="p">(</span><span class="n">TinyGPS</span> <span class="o">&amp;</span><span class="n">gps</span><span class="p">);</span>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_str</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o"><em></span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">//Serial.begin(115200);</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Testing TinyGPS library v. &quot;</span><span class="p">);</span> <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">TinyGPS</span><span class="o">::</span><span class="n">library_version</span><span class="p">());</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;by Mikal Hart&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Sats HDOP Latitude  Longitude  Fix  Date       Time     Date Alt    Course Speed Card  Distance Course Card  Chars Sentences Checksum&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;          (deg)     (deg)      Age                      Age  (m)    &mdash; from GPS &mdash;-  &mdash;- to London  &mdash;-  RX    RX        Fail&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//ss.begin(4800);</span>
</span><span class='line'>  <span class="n">ss</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
</span><span class='line'>  <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">float</span> <span class="n">flat</span><span class="p">,</span> <span class="n">flon</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">age</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">chars</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">sentences</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">failed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">static</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">LONDON_LAT</span> <span class="o">=</span> <span class="mf">51.508131</span><span class="p">,</span> <span class="n">LONDON_LON</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.128002</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">satellites</span><span class="p">(),</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_SATELLITES</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">hdop</span><span class="p">(),</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_HDOP</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="n">gps</span><span class="p">.</span><span class="n">f_get_position</span><span class="p">(</span><span class="o">&amp;</span><span class="n">flat</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">flon</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">age</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_float</span><span class="p">(</span><span class="n">flat</span><span class="p">,</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_float</span><span class="p">(</span><span class="n">flon</span><span class="p">,</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_AGE</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_date</span><span class="p">(</span><span class="n">gps</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_float</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">f_altitude</span><span class="p">(),</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ALTITUDE</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_float</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">f_course</span><span class="p">(),</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_float</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">f_speed_kmph</span><span class="p">(),</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_SPEED</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_str</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">f_course</span><span class="p">()</span> <span class="o">==</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span> <span class="o">?</span> <span class="s">&quot;</em><strong> &quot;</span> <span class="o">:</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">cardinal</span><span class="p">(</span><span class="n">gps</span><span class="p">.</span><span class="n">f_course</span><span class="p">()),</span> <span class="mi">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">flat</span> <span class="o">==</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span> <span class="o">?</span> <span class="mh">0xFFFFFFFF</span> <span class="o">:</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">TinyGPS</span><span class="o">::</span><span class="n">distance_between</span><span class="p">(</span><span class="n">flat</span><span class="p">,</span> <span class="n">flon</span><span class="p">,</span> <span class="n">LONDON_LAT</span><span class="p">,</span> <span class="n">LONDON_LON</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_float</span><span class="p">(</span><span class="n">flat</span> <span class="o">==</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span> <span class="o">?</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="nl">GPS_INVALID_F_ANGLE</span> <span class="p">:</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">course_to</span><span class="p">(</span><span class="n">flat</span><span class="p">,</span> <span class="n">flon</span><span class="p">,</span> <span class="n">LONDON_LAT</span><span class="p">,</span> <span class="n">LONDON_LON</span><span class="p">),</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_str</span><span class="p">(</span><span class="n">flat</span> <span class="o">==</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_F_ANGLE</span> <span class="o">?</span> <span class="s">&quot;</strong><em> &quot;</span> <span class="o">:</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">cardinal</span><span class="p">(</span><span class="n">TinyGPS</span><span class="o">::</span><span class="n">course_to</span><span class="p">(</span><span class="n">flat</span><span class="p">,</span> <span class="n">flon</span><span class="p">,</span> <span class="n">LONDON_LAT</span><span class="p">,</span> <span class="n">LONDON_LON</span><span class="p">)),</span> <span class="mi">6</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">gps</span><span class="p">.</span><span class="n">stats</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chars</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sentences</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">failed</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">sentences</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">failed</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">smartdelay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">smartdelay</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ms</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>
</span><span class='line'>  <span class="k">do</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">available</span><span class="p">())</span>
</span><span class='line'>      <span class="n">gps</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">millis</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">ms</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_float</span><span class="p">(</span><span class="kt">float</span> <span class="n">val</span><span class="p">,</span> <span class="kt">float</span> <span class="n">invalid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">int</span> <span class="n">prec</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">invalid</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="n">len</span><span class="o">&ndash;</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="sc">&#39;</em>&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="sc">&#39; &#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">prec</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">vi</span> <span class="o">=</span> <span class="n">abs</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">val</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">flen</span> <span class="o">=</span> <span class="n">prec</span> <span class="o">+</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// . and -</span>
</span><span class='line'>    <span class="n">flen</span> <span class="o">+=</span> <span class="n">vi</span> <span class="o">&gt;=</span> <span class="mi">1000</span> <span class="o">?</span> <span class="mi">4</span> <span class="o">:</span> <span class="n">vi</span> <span class="o">&gt;=</span> <span class="mi">100</span> <span class="o">?</span> <span class="mi">3</span> <span class="o">:</span> <span class="n">vi</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">flen</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="sc">&#39; &#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">smartdelay</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_int</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">invalid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">char</span> <span class="n">sz</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">invalid</span><span class="p">)</span>
</span><span class='line'>    <span class="n">strcpy</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="s">&quot;<strong><strong><strong><em>&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="n">sprintf</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="s">&quot;%ld&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
</span><span class='line'>  <span class="n">sz</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">strlen</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>    <span class="n">sz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>    <span class="n">sz</span><span class="p">[</span><span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span>
</span><span class='line'>  <span class="n">smartdelay</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_date</span><span class="p">(</span><span class="n">TinyGPS</span> <span class="o">&amp;</span><span class="n">gps</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">year</span><span class="p">;</span>
</span><span class='line'>  <span class="n">byte</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">minute</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">hundredths</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">age</span><span class="p">;</span>
</span><span class='line'>  <span class="n">gps</span><span class="p">.</span><span class="n">crack_datetime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">year</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">month</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">day</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hour</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">minute</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">second</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hundredths</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">age</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">age</span> <span class="o">==</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_AGE</span><span class="p">)</span>
</span><span class='line'>    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;</em></strong></strong></strong><strong><em> </em></strong><em>**** &quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="kt">char</span> <span class="n">sz</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</span><span class='line'>    <span class="n">sprintf</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="s">&quot;%02d/%02d/%02d %02d:%02d:%02d &quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">minute</span><span class="p">,</span> <span class="n">second</span><span class="p">);</span>
</span><span class='line'>    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">print_int</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">TinyGPS</span><span class="o">::</span><span class="n">GPS_INVALID_AGE</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="n">smartdelay</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">print_str</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o"></em></span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">slen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">slen</span> <span class="o">?</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">:</span> <span class="sc">&#39; &#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="n">smartdelay</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The output of this testing on Serial monitor showed as follow.</p>

<p><img class="center" src="http://neutrofoton.github.io/images/post/2017-05-04-output.png"></p>

<p>If you do not get similar output as above (get <code>*</code> on table output) it means your arduino fails get data from GPS module. Please ensure your GPS led is blinking which indicate it receives data from the GPS satellites.</p>

<p>The other thing that you should ensure is you have the right wiring. RX of the Arduino (pin 4, according to the <code>SoftwareSerial</code> statement) goes to the TX of the GPS. Arduino pin 3 (ss TX) goes to the GPS RX.</p>

<p>To validate the accuracy of GPS output (Latitude, Longitude) showed on Arduino Serial Monitor you can check it on google map.</p>

<h2>References</h2>

<p><ul>
<li><a href="https://www.u-blox.com/sites/default/files/products/documents/NEO-6_DataSheet_(GPS.G6-HW-09005).pdf">NEO-6 u-blox 6 GPS Modules Data Sheet</a></li>
<li><a href="http://www.ayomaonline.com/iot/gy-gps6mv2-neo6mv2-neo-6m-gps-module-with-arduino-usb-ttl/">GY-GPS6MV2  NEO6MV2 (NEO 6M) GPS MODULE WITH ARDUINO / USB TTL</a></li>
<li><a href="https://arduino.stackexchange.com/questions/24235/arduino-softwareserial-cant-get-data-from-neo-6m-gps-module">Arduino SoftwareSerial - can&rsquo;t get data from NEO 6M-GPS module</a></li>
<ul></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Import Existing Git Repository to Another]]></title>
    <link href="http://neutrofoton.github.io/blog/2017/04/17/import-existing-git-repository-to-another/"/>
    <updated>2017-04-17T16:44:53+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2017/04/17/import-existing-git-repository-to-another</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/git.png"></p>

<p>While working with git, we may need to import source code from an existing git repository to our working copy. Merging it and pushing to origin master.
The scenario that I had was :</p>

<p><br/></p>

<ul>
<li> I have a project template that I store on a git repository. Let say the url is <code>http://server/git/template.git</code>
   <img class="center" src="http://neutrofoton.github.io/images/post/2017-04-17-template.png">
</li>
<li>
I have another git repository with url <code>http://server/git/project1.git</code>
   <img class="center" src="http://neutrofoton.github.io/images/post/2017-04-17-project1.png">
</li>
</ul>


<p>What I need from the two repositories are importing all contents (libraries, sources, etc) from <code>template</code> repository into my <code>project1</code> working copy. Since I don&rsquo;t want to coding from zero. To get into what I need, here are the steps.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># git clone project1</span>
</span><span class='line'><span class="nv">$ </span>git clone http://server/git/project1.git
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>project1
</span><span class='line'>
</span><span class='line'><span class="c"># add remote url named REMOTE.TEMPLATE</span>
</span><span class='line'><span class="nv">$ </span>git remote add REMOTE.TEMPLATE http://server/git/template.git
</span><span class='line'>
</span><span class='line'><span class="c"># fetch from REMOTE.TEMPLATE remote url</span>
</span><span class='line'><span class="nv">$ </span>git fetch REMOTE.TEMPLATE
</span><span class='line'>
</span><span class='line'><span class="c"># checkout REMOTE.TEMPLATE/master and create a new branch called TEMPLATE</span>
</span><span class='line'><span class="nv">$ </span>git checkout -b TEMPLATE REMOTE.TEMPLATE/master
</span><span class='line'>
</span><span class='line'><span class="c">#switch back to master branch</span>
</span><span class='line'><span class="nv">$ </span>git checkout master
</span><span class='line'>
</span><span class='line'><span class="c"># merge TEMPLATE brach to master branch</span>
</span><span class='line'><span class="nv">$ </span>git merge TEMPLATE
</span><span class='line'>
</span><span class='line'><span class="c"># commit changes</span>
</span><span class='line'><span class="nv">$ </span>git commit
</span></code></pre></td></tr></table></div></figure>


<p>The next step is checking the merge result on our working copy of master branch.
If what we have been imported already there, now we can remove the remote URL of REMOTE.TEMPLATE
and TEMPLATE branch to get rid of the extra branch before pushing.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># remove REMOTE.TEMPLATE remote address</span>
</span><span class='line'><span class="nv">$ </span>git remote rm REMOTE.TEMPLATE
</span><span class='line'>
</span><span class='line'><span class="c"># remove template branch. It is useful to get rid of the extra branch before pushing</span>
</span><span class='line'><span class="nv">$ </span>git branch -d TEMPLATE
</span><span class='line'>
</span><span class='line'><span class="c"># push to remote origin/master</span>
</span><span class='line'><span class="nv">$ </span>git push
</span></code></pre></td></tr></table></div></figure>


<h2>References</h2>

<ol>
<li><a href="http://stackoverflow.com/questions/1683531/how-to-import-existing-git-repository-into-another">http://stackoverflow.com/questions/1683531/how-to-import-existing-git-repository-into-another</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Working With Multiple Github Account on a Computer]]></title>
    <link href="http://neutrofoton.github.io/blog/2017/03/26/working-with-multiple-github-account-on-a-computer/"/>
    <updated>2017-03-26T23:47:22+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2017/03/26/working-with-multiple-github-account-on-a-computer</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/git.png">
Source control is one of a basic need for software development, especially when we work on a team. Git is one of popular distributed source control. Working with multiple github account on the same computer need a few tricky way. Let&rsquo;s assume we have cloned the repository from github to local computer. The following ways are the simple ways I got on internet.</p>

<h2>Change Remote URL to HTTPS</h2>

<p>This way is by changing the remote URL to HTTPS with the following format.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git remote <span class="nb">set</span>-url origin https://USERNAME@github.com/USERNAME/PROJECTNAME.git
</span></code></pre></td></tr></table></div></figure>


<p>Then do normal git operation such as <code>commit</code>, <code>push</code> etc.
To ensure that the commits appear as performed by USERNAME, we can configure the username and email on our working directory.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git config user.name USERNAME
</span><span class='line'><span class="nv">$ </span>git config user.email USERNAME@example.com
</span></code></pre></td></tr></table></div></figure>


<h2>Multiple SSH Key</h2>

<p>The other way is by using multiple SSH key. <a href="https://code.tutsplus.com/tutorials/quick-tip-how-to-work-with-github-and-multiple-accounts--net-22574">Here</a> is the complete tutorial by <a href="https://twitter.com/jeffrey_way">Jeffrey Way</a></p>

<h2>References</h2>

<ol>
<li><a href="http://stackoverflow.com/questions/3860112/multiple-github-accounts-on-the-same-computer">http://stackoverflow.com/questions/3860112/multiple-github-accounts-on-the-same-computer</a></li>
<li><a href="https://code.tutsplus.com/tutorials/quick-tip-how-to-work-with-github-and-multiple-accounts--net-22574">https://code.tutsplus.com/tutorials/quick-tip-how-to-work-with-github-and-multiple-accounts--net-22574</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[C++ Set With Custom Comparator]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/12/30/c-plus-plus-set-with-custom-comparator/"/>
    <updated>2016-12-30T09:42:04+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/12/30/c-plus-plus-set-with-custom-comparator</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/cpp.png"></p>

<p><code>std::set</code> is a C++ STL container that store unique elements following a specific order. It is defined in the <code>set</code> header file.
<br/></p>

<p>Benefits and Features of <code>std::set</code>[3]:</p>

<p><ol>
<li>Its doesnt allow duplicate elements i.e. it only contains unique elements</li>
<li>
<code>std::set</code> can contain element of any specified type in template argument
</li>
<li>
<code>std::set</code> internally store elements in balanced binary tree
</li>
<li>
 By default <code>std::set</code> uses the operator <code> &lt; </code> for comparing two elements and but if user passes the external sorting criteria i.e. comparator then it uses it instead of default operator <code> &lt; </code>.
</li>
<li>
<code>std::set</code> will keep the inserted elements in sorted order based on the assigned sorting criteria i.e. either by default criteria operator <code> &lt; </code> or by passed comparator (if passed).
</li></p>

<p>In this post the samples only limited to <code>std::set</code> that use custom comparator and store complex object instead of basic data type. The complex object that we will use is reusing class <code>Person</code> on previous post.</p>

<p>Let&rsquo;s create custom class that handles comparation process</p>

<p><figure class='code'><figcaption><span>CustomCompare</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="cp">#ifndef CustomCompare_h</span>
</span><span class='line'><span class="cp">#define CustomCompare_h</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &quot;Person.hpp&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">struct</span> <span class="n">CustomCompare</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">bool</span> <span class="k">operator</span><span class="p">()(</span><span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">lhs</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">bool</span> <span class="k">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">lhs</span><span class="p">.</span><span class="n">getAge</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">.</span><span class="n">getAge</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif </span><span class="cm">/<em> CustomCompare_h </em>/</span><span class="cp"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The following code is an example how to use the comparator class in <code>std:set</code>
<figure class='code'><figcaption><span>sample how to use</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">void</span> <span class="nf">SampleSetWithCustomCompare</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">set</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">,</span><span class="n">CustomCompare</span><span class="o">&gt;</span> <span class="n">setOfPersons</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">setOfPersons</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 1&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">));</span>
</span><span class='line'>    <span class="n">setOfPersons</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 2&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">));</span>
</span><span class='line'>    <span class="n">setOfPersons</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 3&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">));</span>
</span><span class='line'>    <span class="n">setOfPersons</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 4&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="n">set</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">,</span><span class="n">CustomCompare</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">setOfPersons</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span><span class="o">!=</span><span class="n">setOfPersons</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">getName</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; , age : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">getAge</span><span class="p">()</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>References</h2>

<ol>
<li><a href="http://www.cplusplus.com/reference/set/set/">http://www.cplusplus.com/reference/set/set/</a></li>
<li><a href="http://www.wrox.com/WileyCDA/WroxTitle/Professional-C-2nd-Edition.productCd-0470932449.html">http://www.wrox.com/WileyCDA/WroxTitle/Professional-C-2nd-Edition.productCd-0470932449.html</a></li>
<li><a href="http://thispointer.com/stdset-tutorial-part-1-set-usage-details-with-default-sorting-criteria/">http://thispointer.com/stdset-tutorial-part-1-set-usage-details-with-default-sorting-criteria/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[C++ Priority Queue With Comparator]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/12/29/c-plus-plus-priority-queue-with-comparator/"/>
    <updated>2016-12-29T14:52:23+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/12/29/c-plus-plus-priority-queue-with-comparator</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/cpp.png"></p>

<p><code>priority_queue</code> is categorized as a STL container adaptor. It is like a queue that keeps its element in sorted order. Instead of a strict FIFO ordering, the element at the head of the queue at any given time is the one with the highest priority.</p>

<p>The template class definition of <code>priority_queue</code> is as follow</p>

<figure class='code'><figcaption><span>template definition</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">template</span> <span class="o">&lt;</span>
</span><span class='line'>   <span class="k">class</span> <span class="nc">Type</span><span class="p">,</span>
</span><span class='line'>   <span class="k">class</span> <span class="nc">Container</span><span class="o">=</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;</span><span class="p">,</span>
</span><span class='line'>   <span class="k">class</span> <span class="nc">Compare</span><span class="o">=</span><span class="n">less</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Container</span><span class="o">::</span><span class="n">value_type</span><span class="o">&gt;</span> <span class="o">&gt;</span>
</span><span class='line'><span class="k">class</span> <span class="nc">priority_queue</span>
</span></code></pre></td></tr></table></div></figure>


<p>A user-provided compare can be supplied to change the ordering, e.g. using <code>std::greater<T></code> would cause the smallest element to appear as the top(). We also can create custom comparator for our need.</p>

<p>Many samples available on net about <code>priority_queue</code> with default compare parameter. In this article let&rsquo;s create samples by specifying the compare parameter template.</p>

<figure class='code'><figcaption><span>priority_queue with std::greater</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="c1">//helper function displays sorted data</span>
</span><span class='line'><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span><span class='line'><span class="kt">void</span> <span class="n">printQueue</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">q</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="n">SamplePriorityQueue</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">greater</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">n</span> <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">})</span>
</span><span class='line'>        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">printQueue</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The code above uses <code>std::greater</code> as a compare parameter template.</p>

<figure class='code'><figcaption><span>output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>0
</span><span class='line'>1
</span><span class='line'>2
</span><span class='line'>3
</span><span class='line'>4
</span><span class='line'>5
</span><span class='line'>6
</span><span class='line'>7
</span><span class='line'>8
</span><span class='line'>9
</span></code></pre></td></tr></table></div></figure>


<p>Beside the <code>std::less</code> or <code>std::greater</code>, we can create our custom comparator with lamda or custom class or struct.</p>

<figure class='code'><figcaption><span>lamda as compare parameter</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">void</span> <span class="nf">SamplePriorityQueueWithLamda</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// using lambda to compare elements.</span>
</span><span class='line'>    <span class="k">auto</span> <span class="n">compare</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">int</span> <span class="n">lhs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rhs</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">return</span> <span class="n">lhs</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">;</span>
</span><span class='line'>                <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="k">decltype</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">(</span><span class="n">compare</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">n</span> <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">})</span>
</span><span class='line'>        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="n">printQueue</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To use the custom comparator, we just need to pass it as the third parameter of <code>priority_queue</code> template</p>

<figure class='code'><figcaption><span>custom comparator</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">struct</span> <span class="n">CustomCompare</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">bool</span> <span class="k">operator</span><span class="p">()(</span><span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">lhs</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>sample with custom comparator</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">void</span> <span class="nf">SamplePriorityQueueWithCustomComparator</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">CustomCompare</span> <span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span><span class='line'>    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span><span class='line'>    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">printQueue</span><span class="p">(</span><span class="n">pq</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The data stored in <code>priority_queue</code> is not limited to basic data type.
We can store object in it. Let&rsquo;s create a sample of it.
Let&rsquo;s say we have a <code>Person</code> class.</p>

<figure class='code'><figcaption><span>Person.hpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="cp">#ifndef Person_hpp</span>
</span><span class='line'><span class="cp">#define Person_hpp</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Person</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="n">Person</span><span class="p">();</span>
</span><span class='line'>    <span class="n">Person</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">);</span>
</span><span class='line'>    <span class="k">virtual</span> <span class="o">~</span><span class="n">Person</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">string</span> <span class="n">getName</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">getAge</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">);</span>
</span><span class='line'>    <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&gt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span><span class="o">:</span>
</span><span class='line'>    <span class="n">string</span> <span class="n">name</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif </span><span class="cm">/* Person_hpp */</span><span class="cp"></span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Person.cpp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="cp">#include &quot;Person.hpp&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">lhs</span><span class="p">.</span><span class="n">getAge</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">.</span><span class="n">getAge</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">bool</span> <span class="k">operator</span> <span class="o">&gt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">lhs</span><span class="p">.</span><span class="n">getAge</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">rhs</span><span class="p">.</span><span class="n">getAge</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">)</span><span class="o">:</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">age</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">string</span> <span class="n">Person</span><span class="o">::</span><span class="n">getName</span><span class="p">()</span> <span class="k">const</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">Person</span><span class="o">::</span><span class="n">getAge</span><span class="p">()</span> <span class="k">const</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">age</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>On the <code>Person</code> class, we have friend overloading methods, right angle bracket and left angle bracket. The methods act as comparation operator. The operator overloading is needed if we want to use <code>std::less</code> or <code>std::greater</code>.</p>

<figure class='code'><figcaption><span>sample priority_queue stores object</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">void</span> <span class="nf">SamplePriorityQueueStoreObject</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">personVector</span> <span class="o">=</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 1&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
</span><span class='line'>        <span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 2&quot;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
</span><span class='line'>        <span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 3&quot;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
</span><span class='line'>        <span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 4&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
</span><span class='line'>        <span class="n">Person</span><span class="p">(</span><span class="s">&quot;Person 5&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;======== Less Priority Queue ======= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">less</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;::</span><span class="n">value_type</span><span class="o">&gt;&gt;</span> <span class="n">pqueue_less</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//fill pqueue_less</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">personVector</span><span class="p">.</span><span class="n">cbegin</span><span class="p">();</span> <span class="n">it</span><span class="o">!=</span><span class="n">personVector</span><span class="p">.</span><span class="n">cend</span><span class="p">();</span> <span class="n">it</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">pqueue_less</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//iterate,display and pop</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">pqueue_less</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">Person</span> <span class="n">value</span> <span class="o">=</span> <span class="n">pqueue_less</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
</span><span class='line'>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">value</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">value</span><span class="p">.</span><span class="n">getAge</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">pqueue_less</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;======== Greater Priority Queue ======= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;::</span><span class="n">value_type</span><span class="o">&gt;&gt;</span> <span class="n">pqueue_greater</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">//fill pqueue_greater</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">personVector</span><span class="p">.</span><span class="n">cbegin</span><span class="p">();</span> <span class="n">it</span><span class="o">!=</span><span class="n">personVector</span><span class="p">.</span><span class="n">cend</span><span class="p">();</span> <span class="n">it</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">pqueue_greater</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//iterate,display and pop</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">pqueue_greater</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">Person</span> <span class="n">value</span> <span class="o">=</span> <span class="n">pqueue_greater</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
</span><span class='line'>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">value</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">value</span><span class="p">.</span><span class="n">getAge</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">pqueue_greater</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>References</h2>

<ol>
<li><a href="http://en.cppreference.com/w/cpp/container/priority_queue">http://en.cppreference.com/w/cpp/container/priority_queue</a></li>
<li><a href="https://support.microsoft.com/en-us/kb/837697">https://support.microsoft.com/en-us/kb/837697</a></li>
<li><a href="http://www.wrox.com/WileyCDA/WroxTitle/Professional-C-2nd-Edition.productCd-0470932449.html">http://www.wrox.com/WileyCDA/WroxTitle/Professional-C-2nd-Edition.productCd-0470932449.html</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Reset Git Credential on OS X Keychain]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/11/09/reset-git-credential-on-os-x-keychain/"/>
    <updated>2016-11-09T12:40:34+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/11/09/reset-git-credential-on-os-x-keychain</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/git.png">
This post basically just a note for my self. In case I got the same condition in the next, it can help me to remember what I did in the past.</p>

<p>I got a condition which I have just changed my git password. Surely I cannot pull or push since my local credential was not valid anymore. When I run <code>git config &ndash;list</code>, I believe my git password stored on OS X Keychain. The simple way I do was running a command via terminal :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git config credential.helper osxkeychain
</span></code></pre></td></tr></table></div></figure>


<p>I was then prompted to input my username and password. By inputing my username and new password everything back to normal.</p>

<p>If you want it to apply globally just append parameter <code> &ndash;global </code> to the command.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git config --global credential.helper osxkeychain
</span></code></pre></td></tr></table></div></figure>


<h2>References</h2>

<ol>
<li><a href="http://stackoverflow.com/questions/20195304/how-to-update-password-for-git">http://stackoverflow.com/questions/20195304/how-to-update-password-for-git</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu Server Does Not Recognize VirtualBox Adapter]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/10/12/ubuntu-server-does-not-recognize-virtualbox-adapter/"/>
    <updated>2016-10-12T21:25:24+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/10/12/ubuntu-server-does-not-recognize-virtualbox-adapter</id>
    <content type="html"><![CDATA[<p>As we know, VirtualBox provides several adapters that we can add and be used by OS guest.
At the time of writing this post, I have an OS X (host) and Ubuntu Server 16.04.1 LTS (guest). The needs are, I want to be able to remote my Ubuntu from OS X terminal. I also want my Ubuntu guest can connect to internet. I have configured two network adapters for the guest (NAT and host-only).</p>

<p>When I run</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>ifconfig
</span></code></pre></td></tr></table></div></figure>


<p>The first/default adapter (NAT) <code>enp0s3</code> is recognized without any problems by the guest. But not the second one (host-only). To make the second adapter visible, I have to run  a command</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo dhclient
</span><span class='line'><span class="nv">$ </span>ifconfig
</span></code></pre></td></tr></table></div></figure>


<p>Now I got both adapters <code>enp0s3</code> (NAT) and <code>enp0s8</code> (host-only) visible on terminal. And now I can ping and run ssh from host (OS X) to guest (Ubuntu server).</p>

<p>In order to make it permanent, we need to edit <code>/etc/network/interfaces</code> with the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># The second network interface</span>
</span><span class='line'>auto enp0s8
</span><span class='line'>iface enp0s8 inet dhcp
</span></code></pre></td></tr></table></div></figure>


<p>Then restart the network service by running</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo /etc/init.d/networking restart
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s my note for now and thanks for reading.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mono Multiple Application on a Virtual Host]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/09/19/mono-multiple-application-on-a-virtual-host/"/>
    <updated>2016-09-19T22:06:13+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/09/19/mono-multiple-application-on-a-virtual-host</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/mono.png">
On my previous post I wrote how to configure application virtual host. We can have multiple application in a virtual host like multiple application in a web site on IIS. To do that, the steps are the same as I did on my previous post. Let&rsquo;s say we have a scenario, having a site config as the sample on previous article, an application port 99, default document root <code>/var/www/vhosts/defaultsite/root</code>. The detail virtual host config as follow</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;VirtualHost</span> <span class="err">*:99</span><span class="nt">&gt;</span>
</span><span class='line'>    ServerAdmin admin@test.com
</span><span class='line'>    ServerName  neutro.local
</span><span class='line'>    ServerAlias neutrofoton.com *.neutrofoton.com
</span><span class='line'>
</span><span class='line'>    MonoServerPath neutro.local &quot;/usr/bin/mod-mono-server4&quot;
</span><span class='line'>    MonoDebug neutro.local true
</span><span class='line'>    MonoSetEnv neutro.local MONO_IOMAP=all
</span><span class='line'>    MonoApplications neutro.local &quot;/:/var/www/vhosts/defaultsite/root&quot;
</span><span class='line'>
</span><span class='line'>    MonoAutoApplication disabled
</span><span class='line'>    AddHandler  mono    .aspx .ascx .asax .ashx .config .cs .asmx .axd
</span><span class='line'>
</span><span class='line'>    DocumentRoot    /var/www/vhosts/defaultsite/root
</span><span class='line'>    DirectoryIndex  Default.aspx index.aspx index.html
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;Location</span> <span class="err">&quot;/&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      Allow from all
</span><span class='line'>      Order allow,deny
</span><span class='line'>    MonoSetServerAlias neutro.local
</span><span class='line'>      SetHandler mono
</span><span class='line'>      SetOutputFilter DEFLATE
</span><span class='line'>      SetEnvIfNoCase Request_URI &quot;\.(?:gif|jpe?g|png)$&quot; no-gzip dont-vary
</span><span class='line'>    <span class="nt">&lt;/Location&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;IfModule</span> <span class="err">mod_deflate.c</span><span class="nt">&gt;</span>
</span><span class='line'>      AddOutputFilterByType DEFLATE text/html text/plain text/xml text/javascript
</span><span class='line'>    <span class="nt">&lt;/IfModule&gt;</span>
</span><span class='line'>
</span><span class='line'>    LogLevel    debug
</span><span class='line'>
</span><span class='line'>    ErrorLog ${APACHE_LOG_DIR}/error.log
</span><span class='line'>    CustomLog ${APACHE_LOG_DIR}/access.log combined
</span><span class='line'><span class="nt">&lt;/VirtualHost&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The steps to enable site config is the same as privious post. To make virtual host have multiple applications, we have to modify the site config file as follow. In this sample, we are going to add 2 applications to this virtual host</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;VirtualHost</span> <span class="err">*:99</span><span class="nt">&gt;</span>
</span><span class='line'>    ServerAdmin admin@test.com
</span><span class='line'>    ServerName  neutro.local
</span><span class='line'>    ServerAlias neutrofoton.com *.neutrofoton.com
</span><span class='line'>
</span><span class='line'>    MonoServerPath neutro.local &quot;/usr/bin/mod-mono-server4&quot;
</span><span class='line'>    MonoDebug neutro.local true
</span><span class='line'>    MonoSetEnv neutro.local MONO_IOMAP=all
</span><span class='line'>    MonoApplications neutro.local &quot;/:/var/www/vhosts/defaultsite/root&quot;
</span><span class='line'>
</span><span class='line'>    MonoAutoApplication disabled
</span><span class='line'>    AddHandler  mono    .aspx .ascx .asax .ashx .config .cs .asmx .axd
</span><span class='line'>
</span><span class='line'>    DocumentRoot    /var/www/vhosts/defaultsite/root
</span><span class='line'>    DirectoryIndex  Default.aspx index.aspx index.html
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;Location</span> <span class="err">&quot;/&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      Allow from all
</span><span class='line'>      Order allow,deny
</span><span class='line'>    MonoSetServerAlias neutro.local
</span><span class='line'>      SetHandler mono
</span><span class='line'>      SetOutputFilter DEFLATE
</span><span class='line'>      SetEnvIfNoCase Request_URI &quot;\.(?:gif|jpe?g|png)$&quot; no-gzip dont-vary
</span><span class='line'>    <span class="nt">&lt;/Location&gt;</span>
</span><span class='line'>
</span><span class='line'>    Alias   /project1  &quot;/home/neutro/Workspace/dotnet/project1&quot;
</span><span class='line'>    MonoApplications project1 &quot;/project1:/home/neutro/Workspace/dotnet/project1&quot;
</span><span class='line'>    MonoServerPath project1 &quot;/usr/bin/mod-mono-server4&quot;
</span><span class='line'>    <span class="nt">&lt;Location</span> <span class="err">&quot;/project1&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      Allow from all
</span><span class='line'>      Order allow,deny
</span><span class='line'>      MonoSetServerAlias project1
</span><span class='line'>      SetHandler mono
</span><span class='line'>      SetOutputFilter DEFLATE
</span><span class='line'>      SetEnvIfNoCase Request_URI &quot;\.(?:gif|jpe?g|png)$&quot; no-gzip dont-vary
</span><span class='line'>      Require all granted
</span><span class='line'>    <span class="nt">&lt;/Location&gt;</span>
</span><span class='line'>
</span><span class='line'>    Alias   /project2  &quot;/home/neutro/Workspace/dotnet/project2&quot;
</span><span class='line'>    MonoApplications project2 &quot;/project2:/home/neutro/Workspace/dotnet/project2&quot;
</span><span class='line'>    MonoServerPath project2 &quot;/usr/bin/mod-mono-server4&quot;
</span><span class='line'>    <span class="nt">&lt;Location</span> <span class="err">&quot;/project2&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      Allow from all
</span><span class='line'>      Order allow,deny
</span><span class='line'>      MonoSetServerAlias project2
</span><span class='line'>      SetHandler mono
</span><span class='line'>      SetOutputFilter DEFLATE
</span><span class='line'>      SetEnvIfNoCase Request_URI &quot;\.(?:gif|jpe?g|png)$&quot; no-gzip dont-vary
</span><span class='line'>      Require all granted
</span><span class='line'>    <span class="nt">&lt;/Location&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;IfModule</span> <span class="err">mod_deflate.c</span><span class="nt">&gt;</span>
</span><span class='line'>      AddOutputFilterByType DEFLATE text/html text/plain text/xml text/javascript
</span><span class='line'>    <span class="nt">&lt;/IfModule&gt;</span>
</span><span class='line'>
</span><span class='line'>    LogLevel    debug
</span><span class='line'>
</span><span class='line'>    ErrorLog ${APACHE_LOG_DIR}/error.log
</span><span class='line'>    CustomLog ${APACHE_LOG_DIR}/access.log combined
</span><span class='line'><span class="nt">&lt;/VirtualHost&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the new virtual host configuration we have:</p>

<ol>
<li><code>/project1</code>, with physical application&rsquo;s files in <code>/home/neutro/Workspace/dotnet/project1</code></li>
<li><code>/project2</code>, with physical application&rsquo;s files in <code>/home/neutro/Workspace/dotnet/project2</code></li>
</ol>


<p>Let&rsquo;s assume we have a simple <code>index.aspx</code> file in <code>/home/neutro/Workspace/dotnet/project1</code> and <code>/home/neutro/Workspace/dotnet/project2</code></p>

<p>We need to give access to both folders and theirs file contents</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>find project1 -type d -exec chmod <span class="m">755</span> <span class="o">{}</span> <span class="se">\;</span>
</span><span class='line'><span class="nv">$ </span>find project1 -type f -exec chmod <span class="m">644</span> <span class="o">{}</span> <span class="se">\;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>find project2 -type d -exec chmod <span class="m">755</span> <span class="o">{}</span> <span class="se">\;</span>
</span><span class='line'><span class="nv">$ </span>find project2 -type f -exec chmod <span class="m">644</span> <span class="o">{}</span> <span class="se">\;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After modifying the config file and give access to the application directories, we need to register the applications in <code>/etc/mono-server4/debian.webapp</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;apps&gt;</span>
</span><span class='line'>   <span class="nt">&lt;web-application&gt;</span>
</span><span class='line'>        <span class="nt">&lt;name&gt;</span>project1<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>        <span class="nt">&lt;vpath&gt;</span>/project1<span class="nt">&lt;/vpath&gt;</span>
</span><span class='line'>        <span class="nt">&lt;path&gt;</span>/home/neutro/Workspace/dotnet/project1<span class="nt">&lt;/path&gt;</span>
</span><span class='line'>        <span class="nt">&lt;vhost&gt;</span>neutro.local<span class="nt">&lt;/vhost&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/web-application&gt;</span>
</span><span class='line'>    <span class="nt">&lt;web-application&gt;</span>
</span><span class='line'>        <span class="nt">&lt;name&gt;</span>project2<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>        <span class="nt">&lt;vpath&gt;</span>/project2<span class="nt">&lt;/vpath&gt;</span>
</span><span class='line'>        <span class="nt">&lt;path&gt;</span>/home/neutro/Workspace/dotnet/project2<span class="nt">&lt;/path&gt;</span>
</span><span class='line'>        <span class="nt">&lt;vhost&gt;</span>neutro.local<span class="nt">&lt;/vhost&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/web-application&gt;</span>
</span><span class='line'><span class="nt">&lt;/apps&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The final step is restart apache, and now we should be able to open in browser <a href="http://localhost:99/project1">http://localhost:99/project1</a> or <a href="http://localhost:99/project2.">http://localhost:99/project2.</a></p>

<h2>References</h2>

<ol>
<li><a href="http://stackoverflow.com/questions/19279286/fail-to-start-a-mono-site-with-apache2-404-error-with-mod-mono">http://stackoverflow.com/questions/19279286/fail-to-start-a-mono-site-with-apache2-404-error-with-mod-mono</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mono Mod_mono Apache2 on Ubuntu]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/09/18/mono-mod-mono-apache2-on-ubuntu/"/>
    <updated>2016-09-18T08:34:23+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/09/18/mono-mod-mono-apache2-on-ubuntu</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/mono.png">
I used to write a post about install and configure Mono on OS X Mountain Lion. On this post I want to summary what I did the similar things on Ubuntu.</p>

<p>The details environment I use :</p>

<ol>
<li>Ubuntu 14.04 LTS</li>
<li>Mono JIT compiler version 4.4.2</li>
<li>Apache 2.4.7</li>
</ol>


<h2>Install Mono, Apache 2, Mod Mono</h2>

<p>To install Mono, the first step is add package repository to our system.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;deb http://download.mono-project.com/repo/debian wheezy main&quot;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/mono-xamarin.list
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>sudo apt-get update
</span></code></pre></td></tr></table></div></figure>


<p>To enable mod_mono installation on Ubuntu 13.10 or later, and Debian 8.0 and later (and their derivatives), we need to add a second repository to our system, in addition to the generic Debian/Ubuntu repository above (if you dont use sudo, be sure to switch to root):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;deb http://download.mono-project.com/repo/debian wheezy-apache24-compat main&quot;</span> <span class="p">|</span> sudo tee -a /etc/apt/sources.list.d/mono-xamarin.list
</span></code></pre></td></tr></table></div></figure>


<p>Then run package update to update and a package upgrade to upgrade existing packages to the latest available.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt-get update
</span><span class='line'><span class="nv">$ </span>sudo apt-get upgrade
</span></code></pre></td></tr></table></div></figure>


<p>To install mono, run the following command</p>

<figure class='code'><figcaption><span>install mono</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt-get install mono-complete
</span></code></pre></td></tr></table></div></figure>


<p>If we do not have Apache 2 on our system, we need to install it first. Or we can check the existing version <code>apache2 -v</code></p>

<figure class='code'><figcaption><span>install apache2</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt-get install apache2
</span></code></pre></td></tr></table></div></figure>


<p>To be able to host ASP.NET application on apache, we need to install <code>mod_mono</code>. <code>mod_mono</code> is a module for the Apache HTTP Server that allows us to host ASP.NET pages and other assemblies on multiple platforms by using Mono.</p>

<p>To install Mod Mono and its dependencies run the following command</p>

<figure class='code'><figcaption><span>install mod_mono</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get install libapache2-mod-mono
</span><span class='line'><span class="nv">$ </span>apt-get install mono-apache-server4
</span></code></pre></td></tr></table></div></figure>


<p>Before going through the next step, the things than we can verify are :</p>

<ol>
<li><p>Ensuring Apache 2 running well at least by checking its version or start stop its service.</p>

<pre><code class="` bash apache version"> $ apache2 -v
</code></pre>

<pre><code class="` bash start apache"> $ service apache2 start
</code></pre>

<pre><code class="` bash stop apache"> $ service apache2 stop
</code></pre></li>
<li><p>Checking mono version</p>

<pre><code class="bash mono version">$ mono --version
</code></pre></li>
<li>Ensuring we have <code>/usr/bin/mod-mono-server4</code></li>
</ol>


<h2>Configuring Application Virtual Host</h2>

<p>To configure virtual host application, the steps are</p>

<ol>
<li><p>Create a directory where the application physical files reside.
In this sample I put my  application files in <code>/var/www/hellodotnet</code></p>

<p>We needed to grant permissions to the login user so that the user could copy or create files to the <code>hellodotnet</code> directory.  For our purposes we made the current user the owner of the directory</p>

<pre><code class="` bash application directory"> $ chown -R -v your_user_name /var/www/
</code></pre></li>
<li><p>Lets create a simple <code>/var/www/hellodotnet/index.aspx</code> file.</p>

<pre><code class="` html index.aspx"> &lt;center&gt;mod_mono is working:&lt;%=System.DateTime.Now.ToString()%&gt;&lt;/center&gt;
</code></pre></li>
<li><p>Create a site configuration <code>/etc/apache2/sites-available/hellodotnet.conf</code></p>

<pre><code class="` xml site configuration">    &lt;VirtualHost *:81&gt;
       ServerName hellodotnet
       ServerAdmin hello@test-apache-config.com
       DocumentRoot /var/www/hellodotnet
       MonoServerPath hellodotnet "/usr/bin/mod-mono-server4"
       MonoDebug hellodotnet true
       MonoSetEnv hellodotnet MONO_IOMAP=all
       MonoApplications hellodotnet "/:/var/www/hellodotnet"

       ErrorLog ${APACHE_LOG_DIR}/error.log
       CustomLog ${APACHE_LOG_DIR}/access.log combined

       AddHandler  mono    .aspx .ascx .asax .ashx .config .cs .asmx .axd
       &lt;Location "/"&gt;
         Allow from all
         Order allow,deny
         MonoSetServerAlias hellodotnet
         SetHandler mono
         SetOutputFilter DEFLATE
         SetEnvIfNoCase Request_URI "\.(?:gif|jpe?g|png)$" no-gzip dont-vary
       &lt;/Location&gt;
       &lt;IfModule mod_deflate.c&gt;
         AddOutputFilterByType DEFLATE text/html text/plain text/xml text/javascript
       &lt;/IfModule&gt;
     &lt;/VirtualHost&gt;
</code></pre>

<p>In this site I use port 81 instead of default 80.</p></li>
<li><p>Since we use port 81, we need to register port 81 in <code>/etc/apache2/ports.conf</code> by simply add the following code</p>

<pre><code class="` bash"> Listen 81
</code></pre></li>
<li><p>Enabling the site by running the following command from terminal</p>

<pre><code class="` bash"> $ sudo a2ensite hellodotnet.conf
</code></pre></li>
<li>Restart apache</li>
<li>Hit from browser : <a href="http://localhost:81">http://localhost:81</a>
We should have the page displayed current date time.</li>
</ol>


<h2>Tips</h2>

<ol>
<li><p>If we get the page not displayed, we can see the message on the page displayed, HTML error code, or any clue on apache logs located in <code>/var/log/apache2</code></p></li>
<li><p>If we get message access denied cannot access bin, simply change permission of the application site.</p>

<pre><code class="` bash"> $ find hellodotnet -type d -exec chmod 755 {} \;
 $ find hellodotnet -type f -exec chmod 644 {} \;
</code></pre></li>
<li><p>If getting message could not find <code>/etc/mono/registry</code>, simply create the directory.</p>

<pre><code class="` bash"> $ sudo mkdir /etc/mono/registry
</code></pre></li>
<li><p>If getting <code>System.UnauthorizedAccessException</code> access to the path <code>/etc/mono/registry</code>, give access to it as its need, for example</p>

<pre><code class="`` bash">  $ chmod uog+rw /etc/mono/registry
</code></pre></li>
</ol>


<h2>References</h2>

<ol>
<li><a href="http://www.mono-project.com/docs/getting-started/install/linux/">http://www.mono-project.com/docs/getting-started/install/linux/</a></li>
<li><a href="http://stackoverflow.com/questions/34290004/how-to-install-configure-mod-mono-on-ubuntu-14-04-3-lts">http://stackoverflow.com/questions/34290004/how-to-install-configure-mod-mono-on-ubuntu-14-04-3-lts</a></li>
<li><a href="http://www.bloomspire.com/blog/2015/3/9/how-to-host-aspnet-applications-on-linux-p3">http://www.bloomspire.com/blog/2015/3/9/how-to-host-aspnet-applications-on-linux-p3</a></li>
<li><a href="http://superuser.com/questions/882594/permission-denied-because-search-permissions-are-missing-on-a-component-of-the-p">http://superuser.com/questions/882594/permission-denied-because-search-permissions-are-missing-on-a-component-of-the-p</a></li>
<li><a href="https://www.codementor.io/tips/7134438372/access-to-the-path-etc-mono-registry-is-denied">https://www.codementor.io/tips/7134438372/access-to-the-path-etc-mono-registry-is-denied</a></li>
<li><a href="https://retkomma.wordpress.com/2011/10/01/registry-settings-in-mono-on-linux/">https://retkomma.wordpress.com/2011/10/01/registry-settings-in-mono-on-linux/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VirtualBox Share Host Folder Ubuntu Guest]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/09/17/virtualbox-share-host-folder-ubuntu-guest/"/>
    <updated>2016-09-17T10:41:13+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/09/17/virtualbox-share-host-folder-ubuntu-guest</id>
    <content type="html"><![CDATA[<p><a href="https://www.virtualbox.org/">VM VirtualBox</a> is one of free popular <a href="https://en.wikipedia.org/wiki/Hypervisor">hypervisor</a> for x86 computer from Oracle. I use it as part of my development environment, since occasionally I need several different Operating Systems for development and software testing  or deployment testing. When we work with VirtualBox we often need to share folder between host and guest operating system.</p>

<p>Before sharing folder, ensure we have installed Guest Addition that shipped with VirtualBox. To do that :</p>

<ol>
<li>Go to  Device menu > Insert Guest CD Addition Images.</li>
<li>If it automatically mounting and has popup dialog, just hit run otherwise we may have to manually mounting it.</li>
</ol>


<p> I usually restart my OS guest after installing this VirtualBox Guest Addition.</p>

<p>The steps are :</p>

<ul>
<li>Go to Devices menu > Shared Folders > Shared Folder Settings</li>
<li>Select folder path of Host to be shared to Guest OS</li>
<li><p>Checked Make Permanent option if we want to make it permanent</p>

<blockquote><p>On my sample, I shared folder from OS X Host /Volumes/MacintoshHDData/share</p></blockquote>

<p> Till this step is enough for Windows guest. On Ubuntu guest, it need additional steps to make the shared folder accessible in guest.</p></li>
<li><p>When we shared a Host&rsquo;s folder on Ubuntu guest, VirtualBox should create a folder on <code>/Media</code> just like the shared folder name with <code>sf_</code> prefix. In my case <code>/Media/sf_share</code>. If the folder does not exist, open terminal, create directory <code>/Media/sf_share</code> and give folder name</p>

<pre><code>mkdir /Media/sf_share
</code></pre></li>
<li><p>VirtualBox with Ubuntu operating system guest, it added a group called <code>vboxsf</code>. Before we can access the shared folder we have to be a member of the group.</p>

<pre><code class="bash">sudo add user [username] vboxsf
</code></pre>

<p> To verify what groups are username belongs to,</p>

<pre><code class="bash">id [username]
</code></pre></li>
<li><p>Mount the shared folder</p>

<pre><code class="bash">sudo mount -t vboxsf share /media/sf_share
</code></pre></li>
</ul>


<p>Now we should be able to the shared folder via Nautilus (File Manager). To make it automatic mounting, ensure we checked option automatic mounting on shared folder setting dialog.</p>

<h2>References</h2>

<ol>
<li><a href="http://askubuntu.com/questions/456400/why-cant-i-access-a-shared-folder-from-within-my-virtualbox-machine">http://askubuntu.com/questions/456400/why-cant-i-access-a-shared-folder-from-within-my-virtualbox-machine</a></li>
<li><a href="http://www.howtogeek.com/187703/how-to-access-folders-on-your-host-machine-from-an-ubuntu-virtual-machine-in-virtualbox/">http://www.howtogeek.com/187703/how-to-access-folders-on-your-host-machine-from-an-ubuntu-virtual-machine-in-virtualbox/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lambda in C++]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/05/11/lambda-in-c-plus-plus/"/>
    <updated>2016-05-11T23:15:18+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/05/11/lambda-in-c-plus-plus</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/logo/lambda.png">
C++11 adds a new feature called lambda expressions. This allows us to write anonymous functions inline, removing the need to write a separate function or to write a function object, and makes code easier to understand.
For those who are familiar with C# lambda expression, C++ lambda expression is similar. But lambda in C++ has slightly different syntax.</p>

<figure class='code'><figcaption><span>C++11 Lambda Syntax</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>[capture_block](parameters) mutable exception_specification -&gt; return_type {body}
</span></code></pre></td></tr></table></div></figure>


<ol>
<li> <strong><code>capture_block</code></strong> is a comma-separated list of zero or more captures, optionally beginning with a capture-default. Capture list can be passed as follows (see below for the detailed description):
<ol>
<li><code>[a,&b]</code> where a is captured by value and b is captured by reference.</li>
<li><code>[this]</code> captures the this pointer by value</li>
<li><code>[&]</code> captures all automatic variables odr-used in the body of the lambda by reference</li>
<li><code>[=]</code> captures all automatic variables odr-used in the body of the lambda by value</li>
<li><code>[x]</code> captures only x by value and nothing else.</li>
<li><code>[]</code> captures nothing</li>
</ol>
</li>
<li>
<strong><code>parameters</code></strong> is (optional) list of parameters for the lambda expression.
</li>
<li>
<strong><code>mutable</code></strong> is (optional) if variables from the enclosing scope are captured by value, a copy of those variables will become available in the body of the lambda expression. Those copies are marked as const by default, meaning the lambda body cannot change the value of those copies. If the lambda expression is marked as mutable, those copies are not const and the body can modify those local copies.
</li>
<li>
<strong><code>exception_specification</code></strong> is (optional) and can be used to specify which exceptions the body of the lambda expression can throw.
</li>
<li>
<strong><code>return_type</code></strong> is Return type. If not present it's implied by the function return statements (or void if it doesn't return any value)
</li>
</ol>




<h3>Lambda and Direct Invoke</h3>


<p>The following snipped code is an example of lambda expression.</p>

<figure class='code'><figcaption><span>example lambda and directly invoked</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">string</span> <span class="n">result</span> <span class="o">=</span> <span class="p">[](</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">string</span> <span class="p">{</span><span class="k">return</span> <span class="s">&quot;Hi &quot;</span> <span class="o">+</span> <span class="n">str</span><span class="p">;}(</span><span class="s">&quot;neutro&quot;</span><span class="p">);</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The lambda expression above shows that it has a <code>const string&amp;</code> parameter and return a <code>string</code> type. To execute the lambda is by placing round brackets <code>()</code> and put object that will be passed to inside it. The <code>&ldquo;neutro&rdquo;</code> literal string will substitute <code>str</code> parameter. The output of the above code is :</p>

<figure class='code'><figcaption><span>output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>Hi neutro
</span></code></pre></td></tr></table></div></figure>




<h3>Lambda as Variable</h3>


<p>Pointer to a lambda expression can be stored and executed through the function pointer. C++ provides <code>std::function</code> which is a STL template class that provides a very convenient wrapper to a simple function, to a functor or to a lambda expression. We can also use the C++11 <code>auto</code> keyword to make it easier.</p>

<p>To make it clear the following code contains couples of various lambda expressions and store them in variables of type <code>auto</code> or its equivalent in <code>std::function</code> STL template class.</p>

<figure class='code'><figcaption><span>lambda as variable</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="k">auto</span> <span class="n">lambda1</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">{</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="s">&quot;Hello lambda without parameter 1&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="p">};</span>
</span><span class='line'><span class="n">lambda1</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="k">auto</span> <span class="n">lambda2</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="s">&quot;Hello lambda without parameter 2&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="p">};</span>
</span><span class='line'><span class="n">lambda2</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//auto lambda3 = [](void) -&gt; void { cout &lt;&lt;&quot;Hello lambda without parameter 2&quot; &lt;&lt; endl; };</span>
</span><span class='line'><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">lambda3</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">void</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">void</span> <span class="p">{</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="s">&quot;Hello lambda without parameter 2&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="p">};</span>
</span><span class='line'><span class="n">lambda3</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//auto lambda4 = [](const string&amp; str) -&gt; string {return &quot;Hello from &quot; + str;};</span>
</span><span class='line'><span class="n">function</span><span class="o">&lt;</span><span class="n">string</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lambda4</span> <span class="o">=</span> <span class="p">[](</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">string</span> <span class="p">{</span><span class="k">return</span> <span class="s">&quot;Hello from &quot;</span> <span class="o">+</span> <span class="n">str</span><span class="p">;};</span>
</span><span class='line'>
</span><span class='line'><span class="n">string</span> <span class="n">result</span> <span class="o">=</span> <span class="n">lambda4</span><span class="p">(</span><span class="s">&quot;neutro&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The snipped code above shows how lambda expressions stored in variable of auto type or theirs equivalent in <code>std::function</code> type and how to invoke the lambda. <a href="https://oopscenities.net/2012/02/24/c11-stdfunction-and-stdbind/">Here</a> is a good article about <code>std::function</code>.</p>

<h3>Lambda Capture Block</h3>


<p>Lambda Capture Block basically describes how we want to capture variables from the enclosing scope. Capturing a variable means that the variable becomes available inside the body of the lambda. The detail variant of capture block has been described on previous section. The following code shows various scenario how to play with capture block.</p>

<figure class='code'><figcaption><span>lambda capture block</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">int</span> <span class="n">variableA</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="kt">int</span> <span class="n">variableB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="kt">int</span> <span class="n">variableC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Init Values : &quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableA : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableA</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableB : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableC : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableC</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="c1">//--------------------------------------</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;---## lamda 1 ##---&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="k">auto</span> <span class="n">lambda1</span> <span class="o">=</span> <span class="p">[</span><span class="o">=</span><span class="p">](</span><span class="kt">int</span> <span class="n">param</span><span class="p">)</span><span class="o">-&gt;</span> <span class="kt">int</span>     <span class="c1">//==&gt; [=] lambda has default access to variable is by value</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">param</span> <span class="o">=</span> <span class="n">param</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;param inside lambda1 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">param</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>                <span class="k">return</span> <span class="n">param</span><span class="p">;</span>
</span><span class='line'>            <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">lambda1</span><span class="p">(</span><span class="n">variableA</span><span class="p">);</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda1, variableA : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableA</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------------------</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;---## lamda 2 ##---&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="k">auto</span> <span class="n">lambda2</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">int</span>      <span class="c1">//==&gt; [&amp;] lambda has default access to variable is by reference</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">param</span> <span class="o">=</span> <span class="n">param</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>                <span class="n">variableB</span> <span class="o">=</span> <span class="n">variableB</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;param inside lambda2 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">param</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableB inside lambda2 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">return</span> <span class="n">param</span><span class="p">;</span>
</span><span class='line'>            <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">lambda2</span><span class="p">(</span><span class="n">variableA</span><span class="p">);</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda2, variableA : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableA</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda2, variableB : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//-------------------------------------</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;---## lamda 3 ##---&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="k">auto</span> <span class="n">lambda3</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span><span class="o">*</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">int</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="o">*</span><span class="n">param</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">param</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="n">variableB</span> <span class="o">=</span> <span class="n">variableB</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;param inside lambda3 : &quot;</span><span class="o">&lt;&lt;*</span><span class="n">param</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableB inside lambda3 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="o">*</span><span class="n">param</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">result3</span> <span class="o">=</span> <span class="n">lambda3</span><span class="p">(</span><span class="o">&amp;</span><span class="n">variableA</span><span class="p">);</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda3, result3 : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">result3</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda3, variableA : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableA</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda3, variableB : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;---## lamda 4 ##---&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="k">auto</span> <span class="n">lambda4</span> <span class="o">=</span> <span class="p">[</span><span class="o">=</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">variableB</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">variableC</span><span class="p">](</span><span class="kt">int</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="c1">//==&gt; [=, &amp;variableB, &amp;variableC] captures by value by default,</span>
</span><span class='line'>                                             <span class="c1">// except variables variableB and variableC, which are captured by reference.</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">param</span> <span class="o">=</span> <span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="n">variableB</span> <span class="o">=</span> <span class="n">variableB</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="n">variableC</span> <span class="o">=</span> <span class="n">variableC</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;param inside lambda4 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">param</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableB inside lambda4 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableC inside lambda4 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableC</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">param</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">lambda4</span><span class="p">(</span><span class="n">variableA</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda4, variableA : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableA</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda4, variableB : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableB</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda4, variableC : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableC</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;---## lamda 5 ##---&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="k">auto</span> <span class="n">lambda5</span> <span class="o">=</span> <span class="p">[</span><span class="n">variableC</span><span class="p">](</span><span class="kt">int</span> <span class="n">param</span><span class="p">)</span> <span class="k">mutable</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="c1">//==&gt; [variableC] captures only variableC by value and nothing else.</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">param</span> <span class="o">=</span> <span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">variableC</span> <span class="o">=</span> <span class="n">variableC</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">//should mark as mutable lambda, since Cannot assign to a variable captured by copy in a non-mutable lambda</span>
</span><span class='line'>    <span class="c1">//variableB = variableB * 2; //ERROR : variableB not captured, since only capture specific variable that&#39;s variableC</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">///</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;param inside lambda5 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">param</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;variableC inside lambda5 : &quot;</span><span class="o">&lt;&lt;</span><span class="n">variableC</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">param</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">lambda5</span><span class="p">(</span><span class="n">variableA</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda5, variableA : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableA</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After lamda5, variableC : &quot;</span> <span class="o">&lt;&lt;</span><span class="n">variableC</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The output of the sample code is :</p>

<figure class='code'><figcaption><span>output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>Init Values :
</span><span class='line'>variableA : 1
</span><span class='line'>variableB : 1
</span><span class='line'>variableC : 1
</span><span class='line'>
</span><span class='line'>---## lamda 1 ##---
</span><span class='line'>param inside lambda1 : 2
</span><span class='line'>After lamda1, variableA : 1
</span><span class='line'>
</span><span class='line'>---## lamda 2 ##---
</span><span class='line'>param inside lambda2 : 2
</span><span class='line'>variableB inside lambda2 : 2
</span><span class='line'>After lamda2, variableA : 1
</span><span class='line'>After lamda2, variableB : 2
</span><span class='line'>
</span><span class='line'>---## lamda 3 ##---
</span><span class='line'>param inside lambda3 : 2
</span><span class='line'>variableB inside lambda3 : 4
</span><span class='line'>After lamda3, result3 : 2
</span><span class='line'>After lamda3, variableA : 2
</span><span class='line'>After lamda3, variableB : 4
</span><span class='line'>
</span><span class='line'>---## lamda 4 ##---
</span><span class='line'>param inside lambda4 : 4
</span><span class='line'>variableB inside lambda4 : 8
</span><span class='line'>variableC inside lambda4 : 2
</span><span class='line'>After lamda4, variableA : 2
</span><span class='line'>After lamda4, variableB : 8
</span><span class='line'>After lamda4, variableC : 2
</span><span class='line'>
</span><span class='line'>---## lamda 5 ##---
</span><span class='line'>param inside lambda5 : 4
</span><span class='line'>variableC inside lambda5 : 4
</span><span class='line'>After lamda5, variableA : 2
</span><span class='line'>After lamda5, variableC : 2
</span></code></pre></td></tr></table></div></figure>


<p><h4>Reference<h4>
<ol type="1">
<li><a href="http://www.wrox.com/WileyCDA/WroxTitle/Professional-C-2nd-Edition.productCd-0470932449.html">Wrox Professional C++</a></li>
<li><a href="http://en.cppreference.com/w/cpp/language/lambda">http://en.cppreference.com/w/cpp/language/lambda</a></li>
<li><a href="https://oopscenities.net/2012/02/24/c11-stdfunction-and-stdbind/">https://oopscenities.net/2012/02/24/c11-stdfunction-and-stdbind/</a></li>
<li><a href="http://www.drdobbs.com/cpp/lambdas-in-c11/240168241?pgno=1">http://www.drdobbs.com/cpp/lambdas-in-c11/240168241?pgno=1</a></li>
</ol></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Configure Boost (C++ Libraries) on Xcode, Code::Blocks and Visual Studio]]></title>
    <link href="http://neutrofoton.github.io/blog/2016/03/27/configure-boost-c-plus-plus-on-xcode/"/>
    <updated>2016-03-27T20:38:49+07:00</updated>
    <id>http://neutrofoton.github.io/blog/2016/03/27/configure-boost-c-plus-plus-on-xcode</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://neutrofoton.github.io/images/post/2016-03-27-boost.png">
<a href="http://www.boost.org/">Boost</a> is a set of libraries for the C++ programming language that provide support for tasks and structures such as linear algebra, pseudorandom number generation, multithreading, image processing, regular expressions, and unit testing. It contains over eighty individual libraries.<a href="https://en.wikipedia.org/wiki/Boost_(C%2B%2B_libraries)">[2]</a></p>

<p>The other interesting points of <a href="http://www.boost.org/">Boost</a> are :</p>

<ol>
<li>Open source</li>
<li>Cross platform</li>
<li>Complement to STL rather than a replacement</li>
<li>Many of <a href="http://www.boost.org/">Boost</a> developers are on the C++ standard committee</li>
<li>Well documented</li>
<li>Most of the Boost libraries are licensed under the <a href="https://en.wikipedia.org/wiki/Boost_(C%2B%2B_libraries)#License">Boost Software License</a>, designed to allow <a href="http://www.boost.org/">Boost</a> to be used with both free and proprietary software projects</li>
</ol>




<h2>Installation Boost</h2>


<p>Before jumping into steps of configuring <a href="http://www.boost.org/">Boost</a> on various IDE, let&rsquo;s begin with <a href="http://www.boost.org/">Boost</a> installation. To be noted that on this post I run Xcode on OS X, <a href="http://www.codeblocks.org/">Code::Blocks</a>  on Linux (Ubuntu) and Visual Studio on Windows. The detail environments I use are :</p>

<ol>
<li>OS X 10.11.4 El Capitan</li>
<li>Ubuntu 14.04.4 LTS</li>
<li>Xcode Version 7.2</li>
<li>Code::Blocks 13.12, gcc 4.8.4</li>
<li>Visual Studio 2013</li>
<li>Boost 1.60.0</li>
</ol>




<h4>OS X and Linux (Ubuntu)</h4>


<p>There are several ways of <a href="http://www.boost.org/">Boost</a> installation. Instead of build from source code, we can use package manager such as <a href="https://www.macports.org/">MacPorts</a>, <a href="http://brew.sh/">Homebrew</a>, <a href="https://en.wikipedia.org/wiki/Advanced_Packaging_Tool">Advance Package Tool</a>, etc. In this post we will build <a href="http://www.boost.org/">Boost</a> from source code. The installation steps (from source code) on OS X and Ubuntu are the similar. To make it consistent, I use the same installation path for OS X and Ubuntu that is <code>/usr/local/boost_1_60_0</code>. You can use different path if you want. The steps are :</p>

<ol>
<li>Download boost library from <a href="boost.org">Boost website</a></li>
<li>Extract it.</li>
<li>Open terminal, navigate to the extracted directory</li>
<li>Create directory on <code>/usr/local/boost_1_60_0</code>, and ensure IDE has access to the directory. On my case I don't need this step on OS X, but on ubuntu it does.
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo mkdir /usr/local/boost_1_60_0
</span><span class='line'>sudo chmod <span class="m">777</span> -r boost_1_60_0
</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Run command :
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>./bootstrap.sh --prefix<span class="o">=</span>/usr/local/boost_1_60_0
</span><span class='line'>./b2 install
</span></code></pre></td></tr></table></div></figure>
This last step quite take time. So you can have coffee while waiting for it :)
</li>
</ol>


<p>Once the installation finish, we should have generated directory. They are <code>/usr/local/boost_1_60_0/include</code> contains header files and <code>/usr/local/boost_1_60_0/lib</code> contains libraries.</p>

<h4>Windows</h4>


<p>The <a href="http://www.boost.org/">Boost</a> installation step on Windows is also similar to the installation step on OS X and Ubuntu.
The steps are :</p>

<ol>
<li>Download boost library from <a href="boost.org">Boost website</a></li>
<li>Extract it to C:\\boost_1_60_0 </li>
<li>Open Visual Studio command prompt. I use Visual Studio 2013 x86 Native Tools Command Prompt native tool (I have not test using default Windows Command Prompt)
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bat'><span class='line'>C:\<span class="p">&gt;</span> <span class="n">cd</span> C:\boost_<span class="m">1</span>_<span class="m">60</span>_<span class="m">0</span>
</span><span class='line'>C:\boost_<span class="m">1</span>_<span class="m">60</span>_<span class="m">0</span><span class="p">&gt;</span> <span class="n">bootstrap</span>.bat
</span><span class='line'>C:\boost_<span class="m">1</span>_<span class="m">60</span>_<span class="m">0</span>&gt; .\b<span class="m">2</span>
</span></code></pre></td></tr></table></div></figure>
As on OS X and Ubuntu, the last step quite take time.
</li>
</ol>




<h2>Configure <a href="http://www.boost.org/">Boost</a> on IDE(s)</h2>


<p>Before create C++ projects on various IDE, let&rsquo;s create a simple C++ hello world code that use Boost libraries. To simplify the test, I grab sample code from <a href="http://stackoverflow.com/questions/999120/c-hello-world-boost-tee-example-program">here</a></p>

<figure class='code'><figcaption><span>Hello World</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;iostream&gt;</span>
</span><span class='line'><span class="cp">#include &lt;fstream&gt;</span>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#include &lt;boost/iostreams/tee.hpp&gt;</span>
</span><span class='line'><span class="cp">#include &lt;boost/iostreams/stream.hpp&gt;</span>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">boost</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">boost</span><span class="o">::</span><span class="n">iostreams</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">typedef</span> <span class="n">tee_device</span><span class="o">&lt;</span><span class="n">ostream</span><span class="p">,</span> <span class="n">ofstream</span><span class="o">&gt;</span> <span class="n">TeeDevice</span><span class="p">;</span>
</span><span class='line'>    <span class="k">typedef</span> <span class="n">stream</span><span class="o">&lt;</span><span class="n">TeeDevice</span><span class="o">&gt;</span> <span class="n">TeeStream</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">ofstream</span> <span class="n">ofs</span><span class="p">(</span><span class="s">&quot;/Users/neutro/Workspace/cpp/sample.txt&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">TeeDevice</span> <span class="n">my_tee</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span> <span class="n">ofs</span><span class="p">);</span>
</span><span class='line'>    <span class="n">TeeStream</span> <span class="n">my_split</span><span class="p">(</span><span class="n">my_tee</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">my_split</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Hello, World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">my_split</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
</span><span class='line'>    <span class="n">my_split</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The snipped code above just print text and write it to a text file. We just want to ensure the IDE&rsquo;s compiler can compile and build the code that includes <a href="http://www.boost.org/">Boost</a> libraries.</p>

<ul>
  <li>
    <h4>Xcode</h4>
    To include Boost libraries on Xcode project :
    <ol>
    <li>Select Xcode project > Build Setting</li>
    <li>Add <code>/usr/local/boost_1_60_0/include/</code> to the Header Search Paths</li>
    <li>Add <code>/usr/local/boost_1_60_0/lib/</code> to the Library Search Paths</li>
    </ol>

    <img class="center" src="http://neutrofoton.github.io/images/post/2016-03-27-xcode.png">

  </li>
  <li>
    <h4>Code::Blocks</h4>
    To include Boost libraries on Code::Blocks project :
    <ol>
    <li>Right Click on Code::Blocks project > Build Option</li>
    <li>
    Select Compiler tab, add <code>/usr/local/boost_1_60_0/include/</code>
    <img class="center" src="http://neutrofoton.github.io/images/post/2016-03-27-codeblocks1.png">
    </li>
    <li>
    Select Linker tab, add <code>/usr/local/boost_1_60_0/lib/</code>
    <img class="center" src="http://neutrofoton.github.io/images/post/2016-03-27-codeblocks2.png">
    </li>
    </ol>
  </li>
  <li>
    <h4>Visual Studio</h4>
    To include Boost libraries on Visual C++ project :
    <ol>
    <li>Right Click on VC++ project > Properties</li>
    <li>Select VC++ Directories on the left pane</li>
    <li>Add <code>C:\boost_1_60_0</code> on Include Directories item</li>
    <li>Add <code>C:\boost_1_60_0\stage\lib</code> on Include Directories item</li>
    <li>Click OK to close the dialog</li>
    </ol>
    <img class="center" src="http://neutrofoton.github.io/images/post/2016-03-27-vs.png">
  </li>
</ul>


<p>The last is rebuild the above code on selected IDE. We should not got any errors once the IDE can detect the <a href="http://www.boost.org/">Boost</a> directory path.</p>

<p>The sample of this article can be downloaded <a href="https://github.com/neutrofoton/SimpleBoost">here</a></p>

<p><h4>Reference<h4>
<ol type="1">
<li>
<a href="http://www.boost.org/">http://www.boost.org/</a>
</li>
<li>
<a href="https://en.wikipedia.org/wiki/Boost_(C%2B%2B_libraries)">Wikipedia</a>
</li>
</ol></p>
]]></content>
  </entry>
  
</feed>
